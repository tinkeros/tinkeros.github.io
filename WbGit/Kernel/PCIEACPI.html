<!DOCTYPE HTML>
<html style="background-color:#FFFFFF;">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=US-ASCII">
<title>The Temple Operating System</title>
<meta name="keywords" content="Operating System,64-Bit,64 Bit,Temple,OS,TempleOS,Free,Open Source,Public Domain,x86_64">
<meta name="generator" content="TinkerOS V5.09">
<style type="text/css">
.cB0{color:#000000;background-color:#55ffff;}
.cB1{color:#0000aa;background-color:#55ffff;}
.cB2{color:#00aa00;background-color:#55ffff;}
.cB3{color:#00aaaa;background-color:#55ffff;}
.cB5{color:#aa00aa;background-color:#55ffff;}
.cB6{color:#aa5500;background-color:#55ffff;}
.cB7{color:#aaaaaa;background-color:#55ffff;}
.cB9{color:#5555ff;background-color:#55ffff;}
.cBD{color:#ff55ff;background-color:#55ffff;}
.cF0{color:#000000;background-color:#ffffff;}
.cF1{color:#0000aa;background-color:#ffffff;}
.cF2{color:#00aa00;background-color:#ffffff;}
.cF3{color:#00aaaa;background-color:#ffffff;}
.cF4{color:#aa0000;background-color:#ffffff;}
.cF5{color:#aa00aa;background-color:#ffffff;}
.cF6{color:#aa5500;background-color:#ffffff;}
.cF7{color:#aaaaaa;background-color:#ffffff;}
.cF8{color:#555555;background-color:#ffffff;}
.cF9{color:#5555ff;background-color:#ffffff;}
.cFA{color:#55ff55;background-color:#ffffff;}
.cFB{color:#55ffff;background-color:#ffffff;}
.cFC{color:#ff5555;background-color:#ffffff;}
.cFD{color:#ff55ff;background-color:#ffffff;}
.cFE{color:#ffff55;background-color:#ffffff;}
.cFF{color:#ffffff;background-color:#ffffff;}
</style>
</head>
<body style="background-color:#55FFFF; border-style:solid;
	  border-width:8px; border-color:#0000AA;
	  margin-left:auto; margin-right:auto; width:800px; ">
<pre style="font-family:courier;font-size:10pt">
<div style="margin-left:auto; margin-right:auto; width: 640px;">
<a name="l1"></a><span class=cB2>/*</span><span class=cB0>
<a name="l2"></a></span><span class=cB2> * Under PCI, each device has 256 bytes of configuration address space,</span><span class=cB0>
<a name="l3"></a></span><span class=cB2> * of which the first 64 bytes are standardized as follows:</span><span class=cB0>
<a name="l4"></a></span><span class=cB2> */</span><span class=cB0>
<a name="l5"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_VENDOR_ID                0x00        </span><span class=cB2>/* 16 bits */</span><span class=cB0>
<a name="l6"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_DEVICE_ID                0x02        </span><span class=cB2>/* 16 bits */</span><span class=cB0>
<a name="l7"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_COMMAND                0x04        </span><span class=cB2>/* 16 bits */</span><span class=cB0>
<a name="l8"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_COMMAND_IO                0x1        </span><span class=cB2>/* Enable response in I/O space */</span><span class=cB0>
<a name="l9"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_COMMAND_MEMORY        0x2        </span><span class=cB2>/* Enable response in Memory space */</span><span class=cB0>
<a name="l10"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_COMMAND_MASTER        0x4        </span><span class=cB2>/* Enable bus mastering */</span><span class=cB0>
<a name="l11"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_COMMAND_SPECIAL        0x8        </span><span class=cB2>/* Enable response to special cycles */</span><span class=cB0>
<a name="l12"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_COMMAND_INVALIDATE        0x10        </span><span class=cB2>/* Use memory write and invalidate */</span><span class=cB0>
<a name="l13"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_COMMAND_VGA_PALETTE 0x20        </span><span class=cB2>/* Enable palette snooping */</span><span class=cB0>
<a name="l14"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_COMMAND_PARITY        0x40        </span><span class=cB2>/* Enable parity checking */</span><span class=cB0>
<a name="l15"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_COMMAND_WAIT         0x80        </span><span class=cB2>/* Enable address/data stepping */</span><span class=cB0>
<a name="l16"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_COMMAND_SERR        0x100        </span><span class=cB2>/* Enable SERR */</span><span class=cB0>
<a name="l17"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_COMMAND_FAST_BACK        0x200        </span><span class=cB2>/* Enable back-to-back writes */</span><span class=cB0>
<a name="l18"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_COMMAND_INTX_DISABLE 0x400 </span><span class=cB2>/* INTx Emulation Disable */</span><span class=cB0>
<a name="l19"></a>
<a name="l20"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_STATUS                0x06        </span><span class=cB2>/* 16 bits */</span><span class=cB0>
<a name="l21"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_STATUS_INTERRUPT        0x08        </span><span class=cB2>/* Interrupt status */</span><span class=cB0>
<a name="l22"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_STATUS_CAP_LIST        0x10        </span><span class=cB2>/* Support Capability List */</span><span class=cB0>
<a name="l23"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_STATUS_66MHZ        0x20        </span><span class=cB2>/* Support 66 Mhz PCI 2.1 bus */</span><span class=cB0>
<a name="l24"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_STATUS_UDF                0x40        </span><span class=cB2>/* Support User Definable Features [obsolete] */</span><span class=cB0>
<a name="l25"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_STATUS_FAST_BACK        0x80        </span><span class=cB2>/* Accept fast-back to back */</span><span class=cB0>
<a name="l26"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_STATUS_PARITY        0x100        </span><span class=cB2>/* Detected parity error */</span><span class=cB0>
<a name="l27"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_STATUS_DEVSEL_MASK        0x600        </span><span class=cB2>/* DEVSEL timing */</span><span class=cB0>
<a name="l28"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_STATUS_DEVSEL_FAST                0x000
<a name="l29"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_STATUS_DEVSEL_MEDIUM        0x200
<a name="l30"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_STATUS_DEVSEL_SLOW                0x400
<a name="l31"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_STATUS_SIG_TARGET_ABORT        0x800 </span><span class=cB2>/* Set on target abort */</span><span class=cB0>
<a name="l32"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_STATUS_REC_TARGET_ABORT        0x1000 </span><span class=cB2>/* Master ack of &quot; */</span><span class=cB0>
<a name="l33"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_STATUS_REC_MASTER_ABORT        0x2000 </span><span class=cB2>/* Set on master abort */</span><span class=cB0>
<a name="l34"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_STATUS_SIG_SYSTEM_ERROR        0x4000 </span><span class=cB2>/* Set when we drive SERR */</span><span class=cB0>
<a name="l35"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_STATUS_DETECTED_PARITY        0x8000 </span><span class=cB2>/* Set on parity error */</span><span class=cB0>
<a name="l36"></a>
<a name="l37"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_CLASS_REVISION        0x08        </span><span class=cB2>/* High 24 bits are class, low 8 revision */</span><span class=cB0>
<a name="l38"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_REVISION_ID                0x08        </span><span class=cB2>/* Revision ID */</span><span class=cB0>
<a name="l39"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_CLASS_PROG                0x09        </span><span class=cB2>/* Reg. Level Programming Interface */</span><span class=cB0>
<a name="l40"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_CLASS_DEVICE        0x0a        </span><span class=cB2>/* Device class */</span><span class=cB0>
<a name="l41"></a>
<a name="l42"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_CACHE_LINE_SIZE        0x0c        </span><span class=cB2>/* 8 bits */</span><span class=cB0>
<a name="l43"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_LATENCY_TIMER        0x0d        </span><span class=cB2>/* 8 bits */</span><span class=cB0>
<a name="l44"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_HEADER_TYPE                0x0e        </span><span class=cB2>/* 8 bits */</span><span class=cB0>
<a name="l45"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_HEADER_TYPE_NORMAL                0
<a name="l46"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_HEADER_TYPE_BRIDGE                1
<a name="l47"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_HEADER_TYPE_CARDBUS        2
<a name="l48"></a>
<a name="l49"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_BIST                0x0f        </span><span class=cB2>/* 8 bits */</span><span class=cB0>
<a name="l50"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_BIST_CODE_MASK        0x0f        </span><span class=cB2>/* Return result */</span><span class=cB0>
<a name="l51"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_BIST_START                0x40        </span><span class=cB2>/* 1 to start BIST, 2 secs or less */</span><span class=cB0>
<a name="l52"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_BIST_CAPABLE        0x80        </span><span class=cB2>/* 1 if BIST capable */</span><span class=cB0>
<a name="l53"></a>
<a name="l54"></a></span><span class=cB2>/*</span><span class=cB0>
<a name="l55"></a></span><span class=cB2> * Base addresses specify locations in memory or I/O space.</span><span class=cB0>
<a name="l56"></a></span><span class=cB2> * Decoded size can be determined by writing a value of</span><span class=cB0>
<a name="l57"></a></span><span class=cB2> * 0xffffffff to the register, and reading it back.  Only</span><span class=cB0>
<a name="l58"></a></span><span class=cB2> * 1 bits are decoded.</span><span class=cB0>
<a name="l59"></a></span><span class=cB2> */</span><span class=cB0>
<a name="l60"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_BASE_ADDRESS_0        0x10        </span><span class=cB2>/* 32 bits */</span><span class=cB0>
<a name="l61"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_BASE_ADDRESS_1        0x14        </span><span class=cB2>/* 32 bits [htype 0,1 only] */</span><span class=cB0>
<a name="l62"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_BASE_ADDRESS_2        0x18        </span><span class=cB2>/* 32 bits [htype 0 only] */</span><span class=cB0>
<a name="l63"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_BASE_ADDRESS_3        0x1c        </span><span class=cB2>/* 32 bits */</span><span class=cB0>
<a name="l64"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_BASE_ADDRESS_4        0x20        </span><span class=cB2>/* 32 bits */</span><span class=cB0>
<a name="l65"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_BASE_ADDRESS_5        0x24        </span><span class=cB2>/* 32 bits */</span><span class=cB0>
<a name="l66"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_BASE_ADDRESS_SPACE                0x01        </span><span class=cB2>/* 0 = memory, 1 = I/O */</span><span class=cB0>
<a name="l67"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_BASE_ADDRESS_SPACE_IO        0x01
<a name="l68"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_BASE_ADDRESS_SPACE_MEMORY        0x00
<a name="l69"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_BASE_ADDRESS_MEM_TYPE_MASK        0x06
<a name="l70"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_BASE_ADDRESS_MEM_TYPE_32        0x00        </span><span class=cB2>/* 32 bit address */</span><span class=cB0>
<a name="l71"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_BASE_ADDRESS_MEM_TYPE_1M        0x02        </span><span class=cB2>/* Below 1M [obsolete] */</span><span class=cB0>
<a name="l72"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_BASE_ADDRESS_MEM_TYPE_64        0x04        </span><span class=cB2>/* 64 bit address */</span><span class=cB0>
<a name="l73"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_BASE_ADDRESS_MEM_PREFETCH        0x08        </span><span class=cB2>/* prefetchable? */</span><span class=cB0>
<a name="l74"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_BASE_ADDRESS_MEM_MASK        (~0x0fUL)
<a name="l75"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_BASE_ADDRESS_IO_MASK        (~0x03UL)
<a name="l76"></a></span><span class=cB2>/* bit 1 is reserved if address_space = 1 */</span><span class=cB0>
<a name="l77"></a>
<a name="l78"></a></span><span class=cB2>/* Header type 0 (normal devices) */</span><span class=cB0>
<a name="l79"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_CARDBUS_CIS                0x28
<a name="l80"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_SUBSYSTEM_VENDOR_ID        0x2c
<a name="l81"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_SUBSYSTEM_ID        0x2e
<a name="l82"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_ROM_ADDRESS                0x30        </span><span class=cB2>/* Bits 31..11 are address, 10..1 reserved */</span><span class=cB0>
<a name="l83"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_ROM_ADDRESS_ENABLE        0x01
<a name="l84"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_ROM_ADDRESS_MASK        (~0x7ffUL)
<a name="l85"></a>
<a name="l86"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_CAPABILITY_LIST        0x34        </span><span class=cB2>/* Offset of first capability list entry */</span><span class=cB0>
<a name="l87"></a>
<a name="l88"></a></span><span class=cB2>/* 0x35-0x3b are reserved */</span><span class=cB0>
<a name="l89"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_INTERRUPT_LINE        0x3c        </span><span class=cB2>/* 8 bits */</span><span class=cB0>
<a name="l90"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_INTERRUPT_PIN        0x3d        </span><span class=cB2>/* 8 bits */</span><span class=cB0>
<a name="l91"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_MIN_GNT                0x3e        </span><span class=cB2>/* 8 bits */</span><span class=cB0>
<a name="l92"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_MAX_LAT                0x3f        </span><span class=cB2>/* 8 bits */</span><span class=cB0>
<a name="l93"></a>
<a name="l94"></a></span><span class=cB2>/* Header type 1 (PCI-to-PCI bridges) */</span><span class=cB0>
<a name="l95"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_PRIMARY_BUS                0x18        </span><span class=cB2>/* Primary bus number */</span><span class=cB0>
<a name="l96"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_SECONDARY_BUS        0x19        </span><span class=cB2>/* Secondary bus number */</span><span class=cB0>
<a name="l97"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_SUBORDINATE_BUS        0x1a        </span><span class=cB2>/* Highest bus number behind the bridge */</span><span class=cB0>
<a name="l98"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_SEC_LATENCY_TIMER        0x1b        </span><span class=cB2>/* Latency timer for secondary interface */</span><span class=cB0>
<a name="l99"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_IO_BASE                0x1c        </span><span class=cB2>/* I/O range behind the bridge */</span><span class=cB0>
<a name="l100"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_IO_LIMIT                0x1d
<a name="l101"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_IO_RANGE_TYPE_MASK        0x0fUL        </span><span class=cB2>/* I/O bridging type */</span><span class=cB0>
<a name="l102"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_IO_RANGE_TYPE_16        0x00
<a name="l103"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_IO_RANGE_TYPE_32        0x01
<a name="l104"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_IO_RANGE_MASK        (~0x0fUL)
<a name="l105"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_SEC_STATUS                0x1e        </span><span class=cB2>/* Secondary status register, only bit 14 used */</span><span class=cB0>
<a name="l106"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_MEMORY_BASE                0x20        </span><span class=cB2>/* Memory range behind */</span><span class=cB0>
<a name="l107"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_MEMORY_LIMIT        0x22
<a name="l108"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_MEMORY_RANGE_TYPE_MASK 0x0fUL
<a name="l109"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_MEMORY_RANGE_MASK        (~0x0fUL)
<a name="l110"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_PREF_MEMORY_BASE        0x24        </span><span class=cB2>/* Prefetchable memory range behind */</span><span class=cB0>
<a name="l111"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_PREF_MEMORY_LIMIT        0x26
<a name="l112"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_PREF_RANGE_TYPE_MASK 0x0fUL
<a name="l113"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_PREF_RANGE_TYPE_32        0x00
<a name="l114"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_PREF_RANGE_TYPE_64        0x01
<a name="l115"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_PREF_RANGE_MASK        (~0x0fUL)
<a name="l116"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_PREF_BASE_UPPER32        0x28        </span><span class=cB2>/* Upper half of prefetchable memory range */</span><span class=cB0>
<a name="l117"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_PREF_LIMIT_UPPER32        0x2c
<a name="l118"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_IO_BASE_UPPER16        0x30        </span><span class=cB2>/* Upper half of I/O addresses */</span><span class=cB0>
<a name="l119"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_IO_LIMIT_UPPER16        0x32
<a name="l120"></a></span><span class=cB2>/* 0x34 same as for htype 0 */</span><span class=cB0>
<a name="l121"></a></span><span class=cB2>/* 0x35-0x3b is reserved */</span><span class=cB0>
<a name="l122"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_ROM_ADDRESS1        0x38        </span><span class=cB2>/* Same as PCI_ROM_ADDRESS, but for htype 1 */</span><span class=cB0>
<a name="l123"></a></span><span class=cB2>/* 0x3c-0x3d are same as for htype 0 */</span><span class=cB0>
<a name="l124"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_BRIDGE_CONTROL        0x3e
<a name="l125"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_BRIDGE_CTL_PARITY        0x01        </span><span class=cB2>/* Enable parity detection on secondary interface */</span><span class=cB0>
<a name="l126"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_BRIDGE_CTL_SERR        0x02        </span><span class=cB2>/* The same for SERR forwarding */</span><span class=cB0>
<a name="l127"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_BRIDGE_CTL_ISA        0x04        </span><span class=cB2>/* Enable ISA mode */</span><span class=cB0>
<a name="l128"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_BRIDGE_CTL_VGA        0x08        </span><span class=cB2>/* Forward VGA addresses */</span><span class=cB0>
<a name="l129"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_BRIDGE_CTL_MASTER_ABORT        0x20  </span><span class=cB2>/* Report master aborts */</span><span class=cB0>
<a name="l130"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_BRIDGE_CTL_BUS_RESET        0x40        </span><span class=cB2>/* Secondary bus reset */</span><span class=cB0>
<a name="l131"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_BRIDGE_CTL_FAST_BACK        0x80        </span><span class=cB2>/* Fast Back2Back enabled on secondary interface */</span><span class=cB0>
<a name="l132"></a>
<a name="l133"></a></span><span class=cB2>/* Header type 2 (CardBus bridges) */</span><span class=cB0>
<a name="l134"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_CB_CAPABILITY_LIST        0x14
<a name="l135"></a></span><span class=cB2>/* 0x15 reserved */</span><span class=cB0>
<a name="l136"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_CB_SEC_STATUS        0x16        </span><span class=cB2>/* Secondary status */</span><span class=cB0>
<a name="l137"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_CB_PRIMARY_BUS        0x18        </span><span class=cB2>/* PCI bus number */</span><span class=cB0>
<a name="l138"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_CB_CARD_BUS                0x19        </span><span class=cB2>/* CardBus bus number */</span><span class=cB0>
<a name="l139"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_CB_SUBORDINATE_BUS        0x1a        </span><span class=cB2>/* Subordinate bus number */</span><span class=cB0>
<a name="l140"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_CB_LATENCY_TIMER        0x1b        </span><span class=cB2>/* CardBus latency timer */</span><span class=cB0>
<a name="l141"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_CB_MEMORY_BASE_0        0x1c
<a name="l142"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_CB_MEMORY_LIMIT_0        0x20
<a name="l143"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_CB_MEMORY_BASE_1        0x24
<a name="l144"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_CB_MEMORY_LIMIT_1        0x28
<a name="l145"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_CB_IO_BASE_0        0x2c
<a name="l146"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_CB_IO_BASE_0_HI        0x2e
<a name="l147"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_CB_IO_LIMIT_0        0x30
<a name="l148"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_CB_IO_LIMIT_0_HI        0x32
<a name="l149"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_CB_IO_BASE_1        0x34
<a name="l150"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_CB_IO_BASE_1_HI        0x36
<a name="l151"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_CB_IO_LIMIT_1        0x38
<a name="l152"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_CB_IO_LIMIT_1_HI        0x3a
<a name="l153"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_CB_IO_RANGE_MASK        (~0x03UL)
<a name="l154"></a></span><span class=cB2>/* 0x3c-0x3d are same as for htype 0 */</span><span class=cB0>
<a name="l155"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_CB_BRIDGE_CONTROL        0x3e
<a name="l156"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_CB_BRIDGE_CTL_PARITY        0x01        </span><span class=cB2>/* Similar to standard bridge control register */</span><span class=cB0>
<a name="l157"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_CB_BRIDGE_CTL_SERR                0x02
<a name="l158"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_CB_BRIDGE_CTL_ISA                0x04
<a name="l159"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_CB_BRIDGE_CTL_VGA                0x08
<a name="l160"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_CB_BRIDGE_CTL_MASTER_ABORT        0x20
<a name="l161"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_CB_BRIDGE_CTL_CB_RESET        0x40        </span><span class=cB2>/* CardBus reset */</span><span class=cB0>
<a name="l162"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_CB_BRIDGE_CTL_16BIT_INT        0x80        </span><span class=cB2>/* Enable interrupt for 16-bit cards */</span><span class=cB0>
<a name="l163"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_CB_BRIDGE_CTL_PREFETCH_MEM0 0x100        </span><span class=cB2>/* Prefetch enable for both memory regions */</span><span class=cB0>
<a name="l164"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_CB_BRIDGE_CTL_PREFETCH_MEM1 0x200
<a name="l165"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_CB_BRIDGE_CTL_POST_WRITES        0x400
<a name="l166"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_CB_SUBSYSTEM_VENDOR_ID        0x40
<a name="l167"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_CB_SUBSYSTEM_ID                0x42
<a name="l168"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_CB_LEGACY_MODE_BASE                0x44        </span><span class=cB2>/* 16-bit PC Card legacy mode base address (ExCa) */</span><span class=cB0>
<a name="l169"></a></span><span class=cB2>/* 0x48-0x7f reserved */</span><span class=cB0>
<a name="l170"></a>
<a name="l171"></a></span><span class=cB2>/* Capability lists */</span><span class=cB0>
<a name="l172"></a>
<a name="l173"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_CAP_LIST_ID                0        </span><span class=cB2>/* Capability ID */</span><span class=cB0>
<a name="l174"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_CAP_ID_PM                0x01        </span><span class=cB2>/* Power Management */</span><span class=cB0>
<a name="l175"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_CAP_ID_AGP                0x02        </span><span class=cB2>/* Accelerated Graphics Port */</span><span class=cB0>
<a name="l176"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_CAP_ID_VPD                0x03        </span><span class=cB2>/* Vital Product Data */</span><span class=cB0>
<a name="l177"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_CAP_ID_SLOTID        0x04        </span><span class=cB2>/* Slot Identification */</span><span class=cB0>
<a name="l178"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_CAP_ID_MSI                0x05        </span><span class=cB2>/* Message Signalled Interrupts */</span><span class=cB0>
<a name="l179"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_CAP_ID_CHSWP        0x06        </span><span class=cB2>/* CompactPCI HotSwap */</span><span class=cB0>
<a name="l180"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_CAP_ID_PCIX        0x07        </span><span class=cB2>/* PCI-X */</span><span class=cB0>
<a name="l181"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_CAP_ID_HT                0x08        </span><span class=cB2>/* HyperTransport */</span><span class=cB0>
<a name="l182"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_CAP_ID_VNDR        0x09        </span><span class=cB2>/* Vendor specific */</span><span class=cB0>
<a name="l183"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_CAP_ID_DBG                0x0A        </span><span class=cB2>/* Debug port */</span><span class=cB0>
<a name="l184"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_CAP_ID_CCRC        0x0B        </span><span class=cB2>/* CompactPCI Central Resource Control */</span><span class=cB0>
<a name="l185"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_CAP_ID_SHPC         0x0C        </span><span class=cB2>/* PCI Standard Hot-Plug Controller */</span><span class=cB0>
<a name="l186"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_CAP_ID_SSVID        0x0D        </span><span class=cB2>/* Bridge subsystem vendor/device ID */</span><span class=cB0>
<a name="l187"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_CAP_ID_AGP3        0x0E        </span><span class=cB2>/* AGP Target PCI-PCI bridge */</span><span class=cB0>
<a name="l188"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_CAP_ID_EXP         0x10        </span><span class=cB2>/* PCI Express */</span><span class=cB0>
<a name="l189"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_CAP_ID_MSIX        0x11        </span><span class=cB2>/* MSI-X */</span><span class=cB0>
<a name="l190"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_CAP_ID_AF                0x13        </span><span class=cB2>/* PCI Advanced Features */</span><span class=cB0>
<a name="l191"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_CAP_LIST_NEXT        1        </span><span class=cB2>/* Next capability in the list */</span><span class=cB0>
<a name="l192"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_CAP_FLAGS                2        </span><span class=cB2>/* Capability defined flags (16 bits) */</span><span class=cB0>
<a name="l193"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_CAP_SIZEOF                4
<a name="l194"></a>
<a name="l195"></a></span><span class=cB2>/* Power Management Registers */</span><span class=cB0>
<a name="l196"></a>
<a name="l197"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_PM_PMC                2        </span><span class=cB2>/* PM Capabilities Register */</span><span class=cB0>
<a name="l198"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_PM_CAP_VER_MASK        0x0007        </span><span class=cB2>/* Version */</span><span class=cB0>
<a name="l199"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_PM_CAP_PME_CLOCK        0x0008        </span><span class=cB2>/* PME clock required */</span><span class=cB0>
<a name="l200"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_PM_CAP_RESERVED    0x0010  </span><span class=cB2>/* Reserved field */</span><span class=cB0>
<a name="l201"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_PM_CAP_DSI                0x0020        </span><span class=cB2>/* Device specific initialization */</span><span class=cB0>
<a name="l202"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_PM_CAP_AUX_POWER        0x01C0        </span><span class=cB2>/* Auxilliary power support mask */</span><span class=cB0>
<a name="l203"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_PM_CAP_D1                0x0200        </span><span class=cB2>/* D1 power state support */</span><span class=cB0>
<a name="l204"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_PM_CAP_D2                0x0400        </span><span class=cB2>/* D2 power state support */</span><span class=cB0>
<a name="l205"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_PM_CAP_PME                0x0800        </span><span class=cB2>/* PME pin supported */</span><span class=cB0>
<a name="l206"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_PM_CAP_PME_MASK        0xF800        </span><span class=cB2>/* PME Mask of all supported states */</span><span class=cB0>
<a name="l207"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_PM_CAP_PME_D0        0x0800        </span><span class=cB2>/* PME# from D0 */</span><span class=cB0>
<a name="l208"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_PM_CAP_PME_D1        0x1000        </span><span class=cB2>/* PME# from D1 */</span><span class=cB0>
<a name="l209"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_PM_CAP_PME_D2        0x2000        </span><span class=cB2>/* PME# from D2 */</span><span class=cB0>
<a name="l210"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_PM_CAP_PME_D3        0x4000        </span><span class=cB2>/* PME# from D3 (hot) */</span><span class=cB0>
<a name="l211"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_PM_CAP_PME_D3cold        0x8000        </span><span class=cB2>/* PME# from D3 (cold) */</span><span class=cB0>
<a name="l212"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_PM_CAP_PME_SHIFT        11        </span><span class=cB2>/* Start of the PME Mask in PMC */</span><span class=cB0>
<a name="l213"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_PM_CTRL                4        </span><span class=cB2>/* PM control and status register */</span><span class=cB0>
<a name="l214"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_PM_CTRL_STATE_MASK        0x0003        </span><span class=cB2>/* Current power state (D0 to D3) */</span><span class=cB0>
<a name="l215"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_PM_CTRL_NO_SOFT_RESET        0x0008        </span><span class=cB2>/* No reset for D3hot-&gt;D0 */</span><span class=cB0>
<a name="l216"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_PM_CTRL_PME_ENABLE        0x0100        </span><span class=cB2>/* PME pin enable */</span><span class=cB0>
<a name="l217"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_PM_CTRL_DATA_SEL_MASK        0x1e00        </span><span class=cB2>/* Data select (??) */</span><span class=cB0>
<a name="l218"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_PM_CTRL_DATA_SCALE_MASK        0x6000        </span><span class=cB2>/* Data scale (??) */</span><span class=cB0>
<a name="l219"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_PM_CTRL_PME_STATUS        0x8000        </span><span class=cB2>/* PME pin status */</span><span class=cB0>
<a name="l220"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_PM_PPB_EXTENSIONS        6        </span><span class=cB2>/* PPB support extensions (??) */</span><span class=cB0>
<a name="l221"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_PM_PPB_B2_B3        0x40        </span><span class=cB2>/* Stop clock when in D3hot (??) */</span><span class=cB0>
<a name="l222"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_PM_BPCC_ENABLE        0x80        </span><span class=cB2>/* Bus power/clock control enable (??) */</span><span class=cB0>
<a name="l223"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_PM_DATA_REGISTER        7        </span><span class=cB2>/* (??) */</span><span class=cB0>
<a name="l224"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_PM_SIZEOF                8
<a name="l225"></a>
<a name="l226"></a></span><span class=cB2>/* AGP registers */</span><span class=cB0>
<a name="l227"></a>
<a name="l228"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_AGP_VERSION                2        </span><span class=cB2>/* BCD version number */</span><span class=cB0>
<a name="l229"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_AGP_RFU                3        </span><span class=cB2>/* Rest of capability flags */</span><span class=cB0>
<a name="l230"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_AGP_STATUS                4        </span><span class=cB2>/* Status register */</span><span class=cB0>
<a name="l231"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_AGP_STATUS_RQ_MASK        0xff000000        </span><span class=cB2>/* Maximum number of requests - 1 */</span><span class=cB0>
<a name="l232"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_AGP_STATUS_SBA        0x0200        </span><span class=cB2>/* Sideband addressing supported */</span><span class=cB0>
<a name="l233"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_AGP_STATUS_64BIT        0x0020        </span><span class=cB2>/* 64-bit addressing supported */</span><span class=cB0>
<a name="l234"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_AGP_STATUS_FW        0x0010        </span><span class=cB2>/* FW transfers supported */</span><span class=cB0>
<a name="l235"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_AGP_STATUS_RATE4        0x0004        </span><span class=cB2>/* 4x transfer rate supported */</span><span class=cB0>
<a name="l236"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_AGP_STATUS_RATE2        0x0002        </span><span class=cB2>/* 2x transfer rate supported */</span><span class=cB0>
<a name="l237"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_AGP_STATUS_RATE1        0x0001        </span><span class=cB2>/* 1x transfer rate supported */</span><span class=cB0>
<a name="l238"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_AGP_COMMAND                8        </span><span class=cB2>/* Control register */</span><span class=cB0>
<a name="l239"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_AGP_COMMAND_RQ_MASK 0xff000000  </span><span class=cB2>/* Master: Maximum number of requests */</span><span class=cB0>
<a name="l240"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_AGP_COMMAND_SBA        0x0200        </span><span class=cB2>/* Sideband addressing enabled */</span><span class=cB0>
<a name="l241"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_AGP_COMMAND_AGP        0x0100        </span><span class=cB2>/* Allow processing of AGP transactions */</span><span class=cB0>
<a name="l242"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_AGP_COMMAND_64BIT        0x0020         </span><span class=cB2>/* Allow processing of 64-bit addresses */</span><span class=cB0>
<a name="l243"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_AGP_COMMAND_FW        0x0010         </span><span class=cB2>/* Force FW transfers */</span><span class=cB0>
<a name="l244"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_AGP_COMMAND_RATE4        0x0004        </span><span class=cB2>/* Use 4x rate */</span><span class=cB0>
<a name="l245"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_AGP_COMMAND_RATE2        0x0002        </span><span class=cB2>/* Use 2x rate */</span><span class=cB0>
<a name="l246"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_AGP_COMMAND_RATE1        0x0001        </span><span class=cB2>/* Use 1x rate */</span><span class=cB0>
<a name="l247"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_AGP_SIZEOF                12
<a name="l248"></a>
<a name="l249"></a></span><span class=cB2>/* Vital Product Data */</span><span class=cB0>
<a name="l250"></a>
<a name="l251"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_VPD_ADDR                2        </span><span class=cB2>/* Address to access (15 bits!) */</span><span class=cB0>
<a name="l252"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_VPD_ADDR_MASK        0x7fff        </span><span class=cB2>/* Address mask */</span><span class=cB0>
<a name="l253"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_VPD_ADDR_F                0x8000        </span><span class=cB2>/* Write 0, 1 indicates completion */</span><span class=cB0>
<a name="l254"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_VPD_DATA                4        </span><span class=cB2>/* 32-bits of data returned here */</span><span class=cB0>
<a name="l255"></a>
<a name="l256"></a></span><span class=cB2>/* Slot Identification */</span><span class=cB0>
<a name="l257"></a>
<a name="l258"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_SID_ESR                2        </span><span class=cB2>/* Expansion Slot Register */</span><span class=cB0>
<a name="l259"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_SID_ESR_NSLOTS        0x1f        </span><span class=cB2>/* Number of expansion slots available */</span><span class=cB0>
<a name="l260"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_SID_ESR_FIC        0x20        </span><span class=cB2>/* First In Chassis Flag */</span><span class=cB0>
<a name="l261"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_SID_CHASSIS_NR        3        </span><span class=cB2>/* Chassis Number */</span><span class=cB0>
<a name="l262"></a>
<a name="l263"></a></span><span class=cB2>/* Message Signalled Interrupts registers */</span><span class=cB0>
<a name="l264"></a>
<a name="l265"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_MSI_FLAGS                2        </span><span class=cB2>/* Various flags */</span><span class=cB0>
<a name="l266"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_MSI_FLAGS_64BIT        0x80        </span><span class=cB2>/* 64-bit addresses allowed */</span><span class=cB0>
<a name="l267"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_MSI_FLAGS_QSIZE        0x70        </span><span class=cB2>/* Message queue size configured */</span><span class=cB0>
<a name="l268"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_MSI_FLAGS_QMASK        0x0e        </span><span class=cB2>/* Maximum queue size available */</span><span class=cB0>
<a name="l269"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_MSI_FLAGS_ENABLE        0x01        </span><span class=cB2>/* MSI feature enabled */</span><span class=cB0>
<a name="l270"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_MSI_FLAGS_MASKBIT        0x100        </span><span class=cB2>/* 64-bit mask bits allowed */</span><span class=cB0>
<a name="l271"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_MSI_RFU                3        </span><span class=cB2>/* Rest of capability flags */</span><span class=cB0>
<a name="l272"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_MSI_ADDRESS_LO        4        </span><span class=cB2>/* Lower 32 bits */</span><span class=cB0>
<a name="l273"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_MSI_ADDRESS_HI        8        </span><span class=cB2>/* Upper 32 bits (if PCI_MSI_FLAGS_64BIT set) */</span><span class=cB0>
<a name="l274"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_MSI_DATA_32                8        </span><span class=cB2>/* 16 bits of data for 32-bit devices */</span><span class=cB0>
<a name="l275"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_MSI_MASK_32                12        </span><span class=cB2>/* Mask bits register for 32-bit devices */</span><span class=cB0>
<a name="l276"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_MSI_DATA_64                12        </span><span class=cB2>/* 16 bits of data for 64-bit devices */</span><span class=cB0>
<a name="l277"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_MSI_MASK_64                16        </span><span class=cB2>/* Mask bits register for 64-bit devices */</span><span class=cB0>
<a name="l278"></a>
<a name="l279"></a></span><span class=cB2>/* MSI-X registers (these are at offset PCI_MSIX_FLAGS) */</span><span class=cB0>
<a name="l280"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_MSIX_FLAGS                2
<a name="l281"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_MSIX_FLAGS_QSIZE        0x7FF
<a name="l282"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_MSIX_FLAGS_ENABLE        (1 &lt;&lt; 15)
<a name="l283"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_MSIX_FLAGS_MASKALL        (1 &lt;&lt; 14)
<a name="l284"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_MSIX_FLAGS_BIRMASK        (7 &lt;&lt; 0)
<a name="l285"></a>
<a name="l286"></a></span><span class=cB2>/* CompactPCI Hotswap Register */</span><span class=cB0>
<a name="l287"></a>
<a name="l288"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_CHSWP_CSR                2        </span><span class=cB2>/* Control and Status Register */</span><span class=cB0>
<a name="l289"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_CHSWP_DHA                0x01        </span><span class=cB2>/* Device Hiding Arm */</span><span class=cB0>
<a name="l290"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_CHSWP_EIM                0x02        </span><span class=cB2>/* ENUM# Signal Mask */</span><span class=cB0>
<a name="l291"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_CHSWP_PIE                0x04        </span><span class=cB2>/* Pending Insert or Extract */</span><span class=cB0>
<a name="l292"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_CHSWP_LOO                0x08        </span><span class=cB2>/* LED On / Off */</span><span class=cB0>
<a name="l293"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_CHSWP_PI                0x30        </span><span class=cB2>/* Programming Interface */</span><span class=cB0>
<a name="l294"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_CHSWP_EXT                0x40        </span><span class=cB2>/* ENUM# status - extraction */</span><span class=cB0>
<a name="l295"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_CHSWP_INS                0x80        </span><span class=cB2>/* ENUM# status - insertion */</span><span class=cB0>
<a name="l296"></a>
<a name="l297"></a></span><span class=cB2>/* PCI Advanced Feature registers */</span><span class=cB0>
<a name="l298"></a>
<a name="l299"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_AF_LENGTH                2
<a name="l300"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_AF_CAP                3
<a name="l301"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_AF_CAP_TP                0x01
<a name="l302"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_AF_CAP_FLR                0x02
<a name="l303"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_AF_CTRL                4
<a name="l304"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_AF_CTRL_FLR        0x01
<a name="l305"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_AF_STATUS                5
<a name="l306"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_AF_STATUS_TP        0x01
<a name="l307"></a>
<a name="l308"></a></span><span class=cB2>/* PCI-X registers */</span><span class=cB0>
<a name="l309"></a>
<a name="l310"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_X_CMD                2        </span><span class=cB2>/* Modes &amp; Features */</span><span class=cB0>
<a name="l311"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_X_CMD_DPERR_E        0x0001        </span><span class=cB2>/* Data Parity Error Recovery Enable */</span><span class=cB0>
<a name="l312"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_X_CMD_ERO                0x0002        </span><span class=cB2>/* Enable Relaxed Ordering */</span><span class=cB0>
<a name="l313"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_X_CMD_READ_512        0x0000        </span><span class=cB2>/* 512 byte maximum read byte count */</span><span class=cB0>
<a name="l314"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_X_CMD_READ_1K        0x0004        </span><span class=cB2>/* 1Kbyte maximum read byte count */</span><span class=cB0>
<a name="l315"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_X_CMD_READ_2K        0x0008        </span><span class=cB2>/* 2Kbyte maximum read byte count */</span><span class=cB0>
<a name="l316"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_X_CMD_READ_4K        0x000c        </span><span class=cB2>/* 4Kbyte maximum read byte count */</span><span class=cB0>
<a name="l317"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_X_CMD_MAX_READ        0x000c        </span><span class=cB2>/* Max Memory Read Byte Count */</span><span class=cB0>
<a name="l318"></a></span><span class=cB2>/* Max # of outstanding split transactions */</span><span class=cB0>
<a name="l319"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_X_CMD_SPLIT_1        0x0000        </span><span class=cB2>/* Max 1 */</span><span class=cB0>
<a name="l320"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_X_CMD_SPLIT_2        0x0010        </span><span class=cB2>/* Max 2 */</span><span class=cB0>
<a name="l321"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_X_CMD_SPLIT_3        0x0020        </span><span class=cB2>/* Max 3 */</span><span class=cB0>
<a name="l322"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_X_CMD_SPLIT_4        0x0030        </span><span class=cB2>/* Max 4 */</span><span class=cB0>
<a name="l323"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_X_CMD_SPLIT_8        0x0040        </span><span class=cB2>/* Max 8 */</span><span class=cB0>
<a name="l324"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_X_CMD_SPLIT_12        0x0050        </span><span class=cB2>/* Max 12 */</span><span class=cB0>
<a name="l325"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_X_CMD_SPLIT_16        0x0060        </span><span class=cB2>/* Max 16 */</span><span class=cB0>
<a name="l326"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_X_CMD_SPLIT_32        0x0070        </span><span class=cB2>/* Max 32 */</span><span class=cB0>
<a name="l327"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_X_CMD_MAX_SPLIT        0x0070        </span><span class=cB2>/* Max Outstanding Split Transactions */</span><span class=cB0>
<a name="l328"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_X_CMD_VERSION(x)         (</span><span class=cB7>(</span><span class=cB0>(x) &gt;&gt; 12</span><span class=cB7>)</span><span class=cB0> &amp; 3) </span><span class=cB2>/* Version */</span><span class=cB0>
<a name="l329"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_X_STATUS                4        </span><span class=cB2>/* PCI-X capabilities */</span><span class=cB0>
<a name="l330"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_X_STATUS_DEVFN        0x000000ff        </span><span class=cB2>/* A copy of devfn */</span><span class=cB0>
<a name="l331"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_X_STATUS_BUS        0x0000ff00        </span><span class=cB2>/* A copy of bus nr */</span><span class=cB0>
<a name="l332"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_X_STATUS_64BIT        0x00010000        </span><span class=cB2>/* 64-bit device */</span><span class=cB0>
<a name="l333"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_X_STATUS_133MHZ        0x00020000        </span><span class=cB2>/* 133 MHz capable */</span><span class=cB0>
<a name="l334"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_X_STATUS_SPL_DISC        0x00040000        </span><span class=cB2>/* Split Completion Discarded */</span><span class=cB0>
<a name="l335"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_X_STATUS_UNX_SPL        0x00080000        </span><span class=cB2>/* Unexpected Split Completion */</span><span class=cB0>
<a name="l336"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_X_STATUS_COMPLEX        0x00100000        </span><span class=cB2>/* Device Complexity */</span><span class=cB0>
<a name="l337"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_X_STATUS_MAX_READ        0x00600000        </span><span class=cB2>/* Designed Max Memory Read Count */</span><span class=cB0>
<a name="l338"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_X_STATUS_MAX_SPLIT        0x03800000        </span><span class=cB2>/* Designed Max Outstanding Split Transactions */</span><span class=cB0>
<a name="l339"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_X_STATUS_MAX_CUM        0x1c000000        </span><span class=cB2>/* Designed Max Cumulative Read Size */</span><span class=cB0>
<a name="l340"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_X_STATUS_SPL_ERR        0x20000000        </span><span class=cB2>/* Rcvd Split Completion Error Msg */</span><span class=cB0>
<a name="l341"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_X_STATUS_266MHZ        0x40000000        </span><span class=cB2>/* 266 MHz capable */</span><span class=cB0>
<a name="l342"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_X_STATUS_533MHZ        0x80000000        </span><span class=cB2>/* 533 MHz capable */</span><span class=cB0>
<a name="l343"></a>
<a name="l344"></a></span><span class=cB2>/* PCI Express capability registers */</span><span class=cB0>
<a name="l345"></a>
<a name="l346"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_EXP_FLAGS                2        </span><span class=cB2>/* Capabilities register */</span><span class=cB0>
<a name="l347"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_EXP_FLAGS_VERS        0x000f        </span><span class=cB2>/* Capability version */</span><span class=cB0>
<a name="l348"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_EXP_FLAGS_TYPE        0x00f0        </span><span class=cB2>/* Device/Port type */</span><span class=cB0>
<a name="l349"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_TYPE_ENDPOINT        0x0        </span><span class=cB2>/* Express Endpoint */</span><span class=cB0>
<a name="l350"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_TYPE_LEG_END        0x1        </span><span class=cB2>/* Legacy Endpoint */</span><span class=cB0>
<a name="l351"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_TYPE_ROOT_PORT 0x4        </span><span class=cB2>/* Root Port */</span><span class=cB0>
<a name="l352"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_TYPE_UPSTREAM        0x5        </span><span class=cB2>/* Upstream Port */</span><span class=cB0>
<a name="l353"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_TYPE_DOWNSTREAM 0x6        </span><span class=cB2>/* Downstream Port */</span><span class=cB0>
<a name="l354"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_TYPE_PCI_BRIDGE 0x7        </span><span class=cB2>/* PCI/PCI-X Bridge */</span><span class=cB0>
<a name="l355"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_TYPE_RC_END        0x9        </span><span class=cB2>/* Root Complex Integrated Endpoint */</span><span class=cB0>
<a name="l356"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_TYPE_RC_EC        0x10        </span><span class=cB2>/* Root Complex Event Collector */</span><span class=cB0>
<a name="l357"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_EXP_FLAGS_SLOT        0x0100        </span><span class=cB2>/* Slot implemented */</span><span class=cB0>
<a name="l358"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_EXP_FLAGS_IRQ        0x3e00        </span><span class=cB2>/* Interrupt message number */</span><span class=cB0>
<a name="l359"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_EXP_DEVCAP                4        </span><span class=cB2>/* Device capabilities */</span><span class=cB0>
<a name="l360"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_DEVCAP_PAYLOAD        0x07        </span><span class=cB2>/* Max_Payload_Size */</span><span class=cB0>
<a name="l361"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_DEVCAP_PHANTOM        0x18        </span><span class=cB2>/* Phantom functions */</span><span class=cB0>
<a name="l362"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_DEVCAP_EXT_TAG        0x20        </span><span class=cB2>/* Extended tags */</span><span class=cB0>
<a name="l363"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_DEVCAP_L0S        0x1c0        </span><span class=cB2>/* L0s Acceptable Latency */</span><span class=cB0>
<a name="l364"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_DEVCAP_L1        0xe00        </span><span class=cB2>/* L1 Acceptable Latency */</span><span class=cB0>
<a name="l365"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_DEVCAP_ATN_BUT        0x1000        </span><span class=cB2>/* Attention Button Present */</span><span class=cB0>
<a name="l366"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_DEVCAP_ATN_IND        0x2000        </span><span class=cB2>/* Attention Indicator Present */</span><span class=cB0>
<a name="l367"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_DEVCAP_PWR_IND        0x4000        </span><span class=cB2>/* Power Indicator Present */</span><span class=cB0>
<a name="l368"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_DEVCAP_RBER        0x8000        </span><span class=cB2>/* Role-Based Error Reporting */</span><span class=cB0>
<a name="l369"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_DEVCAP_PWR_VAL        0x3fc0000 </span><span class=cB2>/* Slot Power Limit Value */</span><span class=cB0>
<a name="l370"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_DEVCAP_PWR_SCL        0xc000000 </span><span class=cB2>/* Slot Power Limit Scale */</span><span class=cB0>
<a name="l371"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_DEVCAP_FLR     0x10000000 </span><span class=cB2>/* Function Level Reset */</span><span class=cB0>
<a name="l372"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_EXP_DEVCTL                8        </span><span class=cB2>/* Device Control */</span><span class=cB0>
<a name="l373"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_DEVCTL_CERE        0x0001        </span><span class=cB2>/* Correctable Error Reporting En. */</span><span class=cB0>
<a name="l374"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_DEVCTL_NFERE        0x0002        </span><span class=cB2>/* Non-Fatal Error Reporting Enable */</span><span class=cB0>
<a name="l375"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_DEVCTL_FERE        0x0004        </span><span class=cB2>/* Fatal Error Reporting Enable */</span><span class=cB0>
<a name="l376"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_DEVCTL_URRE        0x0008        </span><span class=cB2>/* Unsupported Request Reporting En. */</span><span class=cB0>
<a name="l377"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_DEVCTL_RELAX_EN 0x0010 </span><span class=cB2>/* Enable relaxed ordering */</span><span class=cB0>
<a name="l378"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_DEVCTL_PAYLOAD        0x00e0        </span><span class=cB2>/* Max_Payload_Size */</span><span class=cB0>
<a name="l379"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_DEVCTL_EXT_TAG        0x0100        </span><span class=cB2>/* Extended Tag Field Enable */</span><span class=cB0>
<a name="l380"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_DEVCTL_PHANTOM        0x0200        </span><span class=cB2>/* Phantom Functions Enable */</span><span class=cB0>
<a name="l381"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_DEVCTL_AUX_PME        0x0400        </span><span class=cB2>/* Auxiliary Power PM Enable */</span><span class=cB0>
<a name="l382"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_DEVCTL_NOSNOOP_EN 0x0800  </span><span class=cB2>/* Enable No Snoop */</span><span class=cB0>
<a name="l383"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_DEVCTL_READRQ        0x7000        </span><span class=cB2>/* Max_Read_Request_Size */</span><span class=cB0>
<a name="l384"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_DEVCTL_BCR_FLR 0x8000  </span><span class=cB2>/* Bridge Configuration Retry / FLR */</span><span class=cB0>
<a name="l385"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_EXP_DEVSTA                10        </span><span class=cB2>/* Device Status */</span><span class=cB0>
<a name="l386"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_DEVSTA_CED        0x01        </span><span class=cB2>/* Correctable Error Detected */</span><span class=cB0>
<a name="l387"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_DEVSTA_NFED        0x02        </span><span class=cB2>/* Non-Fatal Error Detected */</span><span class=cB0>
<a name="l388"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_DEVSTA_FED        0x04        </span><span class=cB2>/* Fatal Error Detected */</span><span class=cB0>
<a name="l389"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_DEVSTA_URD        0x08        </span><span class=cB2>/* Unsupported Request Detected */</span><span class=cB0>
<a name="l390"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_DEVSTA_AUXPD        0x10        </span><span class=cB2>/* AUX Power Detected */</span><span class=cB0>
<a name="l391"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_DEVSTA_TRPND        0x20        </span><span class=cB2>/* Transactions Pending */</span><span class=cB0>
<a name="l392"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_EXP_LNKCAP                12        </span><span class=cB2>/* Link Capabilities */</span><span class=cB0>
<a name="l393"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_LNKCAP_SLS        0x0000000f </span><span class=cB2>/* Supported Link Speeds */</span><span class=cB0>
<a name="l394"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_LNKCAP_MLW        0x000003f0 </span><span class=cB2>/* Maximum Link Width */</span><span class=cB0>
<a name="l395"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_LNKCAP_ASPMS        0x00000c00 </span><span class=cB2>/* ASPM Support */</span><span class=cB0>
<a name="l396"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_LNKCAP_L0SEL        0x00007000 </span><span class=cB2>/* L0s Exit Latency */</span><span class=cB0>
<a name="l397"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_LNKCAP_L1EL        0x00038000 </span><span class=cB2>/* L1 Exit Latency */</span><span class=cB0>
<a name="l398"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_LNKCAP_CLKPM        0x00040000 </span><span class=cB2>/* L1 Clock Power Management */</span><span class=cB0>
<a name="l399"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_LNKCAP_SDERC        0x00080000 </span><span class=cB2>/* Suprise Down Error Reporting Capable */</span><span class=cB0>
<a name="l400"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_LNKCAP_DLLLARC        0x00100000 </span><span class=cB2>/* Data Link Layer Link Active Reporting Capable */</span><span class=cB0>
<a name="l401"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_LNKCAP_LBNC        0x00200000 </span><span class=cB2>/* Link Bandwidth Notification Capability */</span><span class=cB0>
<a name="l402"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_LNKCAP_PN        0xff000000 </span><span class=cB2>/* Port Number */</span><span class=cB0>
<a name="l403"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_EXP_LNKCTL                16        </span><span class=cB2>/* Link Control */</span><span class=cB0>
<a name="l404"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_LNKCTL_ASPMC        0x0003        </span><span class=cB2>/* ASPM Control */</span><span class=cB0>
<a name="l405"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_LNKCTL_RCB        0x0008        </span><span class=cB2>/* Read Completion Boundary */</span><span class=cB0>
<a name="l406"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_LNKCTL_LD        0x0010        </span><span class=cB2>/* Link Disable */</span><span class=cB0>
<a name="l407"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_LNKCTL_RL        0x0020        </span><span class=cB2>/* Retrain Link */</span><span class=cB0>
<a name="l408"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_LNKCTL_CCC        0x0040        </span><span class=cB2>/* Common Clock Configuration */</span><span class=cB0>
<a name="l409"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_LNKCTL_ES        0x0080        </span><span class=cB2>/* Extended Synch */</span><span class=cB0>
<a name="l410"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_LNKCTL_CLKREQ_EN 0x100        </span><span class=cB2>/* Enable clkreq */</span><span class=cB0>
<a name="l411"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_LNKCTL_HAWD        0x0200        </span><span class=cB2>/* Hardware Autonomous Width Disable */</span><span class=cB0>
<a name="l412"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_LNKCTL_LBMIE        0x0400        </span><span class=cB2>/* Link Bandwidth Management Interrupt Enable */</span><span class=cB0>
<a name="l413"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_LNKCTL_LABIE        0x0800        </span><span class=cB2>/* Lnk Autonomous Bandwidth Interrupt Enable */</span><span class=cB0>
<a name="l414"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_EXP_LNKSTA                18        </span><span class=cB2>/* Link Status */</span><span class=cB0>
<a name="l415"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_LNKSTA_CLS        0x000f        </span><span class=cB2>/* Current Link Speed */</span><span class=cB0>
<a name="l416"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_LNKSTA_CLS_2_5GB 0x01        </span><span class=cB2>/* Current Link Speed 2.5GT/s */</span><span class=cB0>
<a name="l417"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_LNKSTA_CLS_5_0GB 0x02        </span><span class=cB2>/* Current Link Speed 5.0GT/s */</span><span class=cB0>
<a name="l418"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_LNKSTA_NLW        0x03f0        </span><span class=cB2>/* Nogotiated Link Width */</span><span class=cB0>
<a name="l419"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_LNKSTA_NLW_SHIFT 4        </span><span class=cB2>/* start of NLW mask in link status */</span><span class=cB0>
<a name="l420"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_LNKSTA_LT        0x0800        </span><span class=cB2>/* Link Training */</span><span class=cB0>
<a name="l421"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_LNKSTA_SLC        0x1000        </span><span class=cB2>/* Slot Clock Configuration */</span><span class=cB0>
<a name="l422"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_LNKSTA_DLLLA        0x2000        </span><span class=cB2>/* Data Link Layer Link Active */</span><span class=cB0>
<a name="l423"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_LNKSTA_LBMS        0x4000        </span><span class=cB2>/* Link Bandwidth Management Status */</span><span class=cB0>
<a name="l424"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_LNKSTA_LABS        0x8000        </span><span class=cB2>/* Link Autonomous Bandwidth Status */</span><span class=cB0>
<a name="l425"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_EXP_SLTCAP                20        </span><span class=cB2>/* Slot Capabilities */</span><span class=cB0>
<a name="l426"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_SLTCAP_ABP        0x00000001 </span><span class=cB2>/* Attention Button Present */</span><span class=cB0>
<a name="l427"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_SLTCAP_PCP        0x00000002 </span><span class=cB2>/* Power Controller Present */</span><span class=cB0>
<a name="l428"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_SLTCAP_MRLSP        0x00000004 </span><span class=cB2>/* MRL Sensor Present */</span><span class=cB0>
<a name="l429"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_SLTCAP_AIP        0x00000008 </span><span class=cB2>/* Attention Indicator Present */</span><span class=cB0>
<a name="l430"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_SLTCAP_PIP        0x00000010 </span><span class=cB2>/* Power Indicator Present */</span><span class=cB0>
<a name="l431"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_SLTCAP_HPS        0x00000020 </span><span class=cB2>/* Hot-Plug Surprise */</span><span class=cB0>
<a name="l432"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_SLTCAP_HPC        0x00000040 </span><span class=cB2>/* Hot-Plug Capable */</span><span class=cB0>
<a name="l433"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_SLTCAP_SPLV        0x00007f80 </span><span class=cB2>/* Slot Power Limit Value */</span><span class=cB0>
<a name="l434"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_SLTCAP_SPLS        0x00018000 </span><span class=cB2>/* Slot Power Limit Scale */</span><span class=cB0>
<a name="l435"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_SLTCAP_EIP        0x00020000 </span><span class=cB2>/* Electromechanical Interlock Present */</span><span class=cB0>
<a name="l436"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_SLTCAP_NCCS        0x00040000 </span><span class=cB2>/* No Command Completed Support */</span><span class=cB0>
<a name="l437"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_SLTCAP_PSN        0xfff80000 </span><span class=cB2>/* Physical Slot Number */</span><span class=cB0>
<a name="l438"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_EXP_SLTCTL                24        </span><span class=cB2>/* Slot Control */</span><span class=cB0>
<a name="l439"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_SLTCTL_ABPE        0x0001        </span><span class=cB2>/* Attention Button Pressed Enable */</span><span class=cB0>
<a name="l440"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_SLTCTL_PFDE        0x0002        </span><span class=cB2>/* Power Fault Detected Enable */</span><span class=cB0>
<a name="l441"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_SLTCTL_MRLSCE        0x0004        </span><span class=cB2>/* MRL Sensor Changed Enable */</span><span class=cB0>
<a name="l442"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_SLTCTL_PDCE        0x0008        </span><span class=cB2>/* Presence Detect Changed Enable */</span><span class=cB0>
<a name="l443"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_SLTCTL_CCIE        0x0010        </span><span class=cB2>/* Command Completed Interrupt Enable */</span><span class=cB0>
<a name="l444"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_SLTCTL_HPIE        0x0020        </span><span class=cB2>/* Hot-Plug Interrupt Enable */</span><span class=cB0>
<a name="l445"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_SLTCTL_AIC        0x00c0        </span><span class=cB2>/* Attention Indicator Control */</span><span class=cB0>
<a name="l446"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_SLTCTL_PIC        0x0300        </span><span class=cB2>/* Power Indicator Control */</span><span class=cB0>
<a name="l447"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_SLTCTL_PCC        0x0400        </span><span class=cB2>/* Power Controller Control */</span><span class=cB0>
<a name="l448"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_SLTCTL_EIC        0x0800        </span><span class=cB2>/* Electromechanical Interlock Control */</span><span class=cB0>
<a name="l449"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_SLTCTL_DLLSCE        0x1000        </span><span class=cB2>/* Data Link Layer State Changed Enable */</span><span class=cB0>
<a name="l450"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_EXP_SLTSTA                26        </span><span class=cB2>/* Slot Status */</span><span class=cB0>
<a name="l451"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_SLTSTA_ABP        0x0001        </span><span class=cB2>/* Attention Button Pressed */</span><span class=cB0>
<a name="l452"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_SLTSTA_PFD        0x0002        </span><span class=cB2>/* Power Fault Detected */</span><span class=cB0>
<a name="l453"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_SLTSTA_MRLSC        0x0004        </span><span class=cB2>/* MRL Sensor Changed */</span><span class=cB0>
<a name="l454"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_SLTSTA_PDC        0x0008        </span><span class=cB2>/* Presence Detect Changed */</span><span class=cB0>
<a name="l455"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_SLTSTA_CC        0x0010        </span><span class=cB2>/* Command Completed */</span><span class=cB0>
<a name="l456"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_SLTSTA_MRLSS        0x0020        </span><span class=cB2>/* MRL Sensor State */</span><span class=cB0>
<a name="l457"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_SLTSTA_PDS        0x0040        </span><span class=cB2>/* Presence Detect State */</span><span class=cB0>
<a name="l458"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_SLTSTA_EIS        0x0080        </span><span class=cB2>/* Electromechanical Interlock Status */</span><span class=cB0>
<a name="l459"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_SLTSTA_DLLSC        0x0100        </span><span class=cB2>/* Data Link Layer State Changed */</span><span class=cB0>
<a name="l460"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_EXP_RTCTL                28        </span><span class=cB2>/* Root Control */</span><span class=cB0>
<a name="l461"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_RTCTL_SECEE        0x01        </span><span class=cB2>/* System Error on Correctable Error */</span><span class=cB0>
<a name="l462"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_RTCTL_SENFEE        0x02        </span><span class=cB2>/* System Error on Non-Fatal Error */</span><span class=cB0>
<a name="l463"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_RTCTL_SEFEE        0x04        </span><span class=cB2>/* System Error on Fatal Error */</span><span class=cB0>
<a name="l464"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_RTCTL_PMEIE        0x08        </span><span class=cB2>/* PME Interrupt Enable */</span><span class=cB0>
<a name="l465"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_RTCTL_CRSSVE        0x10        </span><span class=cB2>/* CRS Software Visibility Enable */</span><span class=cB0>
<a name="l466"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_EXP_RTCAP                30        </span><span class=cB2>/* Root Capabilities */</span><span class=cB0>
<a name="l467"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_EXP_RTSTA                32        </span><span class=cB2>/* Root Status */</span><span class=cB0>
<a name="l468"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_EXP_DEVCAP2                36        </span><span class=cB2>/* Device Capabilities 2 */</span><span class=cB0>
<a name="l469"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_DEVCAP2_ARI        0x20        </span><span class=cB2>/* Alternative Routing-ID */</span><span class=cB0>
<a name="l470"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_EXP_DEVCTL2                40        </span><span class=cB2>/* Device Control 2 */</span><span class=cB0>
<a name="l471"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_EXP_DEVCTL2_ARI        0x20        </span><span class=cB2>/* Alternative Routing-ID */</span><span class=cB0>
<a name="l472"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_EXP_LNKCTL2                48        </span><span class=cB2>/* Link Control 2 */</span><span class=cB0>
<a name="l473"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_EXP_SLTCTL2                56        </span><span class=cB2>/* Slot Control 2 */</span><span class=cB0>
<a name="l474"></a>
<a name="l475"></a></span><span class=cB2>/* Extended Capabilities (PCI-X 2.0 and Express) */</span><span class=cB0>
<a name="l476"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_EXT_CAP_ID(header)                (header &amp; 0x0000ffff)
<a name="l477"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_EXT_CAP_VER(header)                (</span><span class=cB7>(</span><span class=cB0>header &gt;&gt; 16</span><span class=cB7>)</span><span class=cB0> &amp; 0xf)
<a name="l478"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_EXT_CAP_NEXT(header)        (</span><span class=cB7>(</span><span class=cB0>header &gt;&gt; 20</span><span class=cB7>)</span><span class=cB0> &amp; 0xffc)
<a name="l479"></a>
<a name="l480"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_EXT_CAP_ID_ERR        1
<a name="l481"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_EXT_CAP_ID_VC        2
<a name="l482"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_EXT_CAP_ID_DSN        3
<a name="l483"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_EXT_CAP_ID_PWR        4
<a name="l484"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_EXT_CAP_ID_ARI        14
<a name="l485"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_EXT_CAP_ID_ATS        15
<a name="l486"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_EXT_CAP_ID_SRIOV        16
<a name="l487"></a>
<a name="l488"></a></span><span class=cB2>/* Advanced Error Reporting */</span><span class=cB0>
<a name="l489"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_ERR_UNCOR_STATUS        4        </span><span class=cB2>/* Uncorrectable Error Status */</span><span class=cB0>
<a name="l490"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_ERR_UNC_TRAIN        0x00000001        </span><span class=cB2>/* Training */</span><span class=cB0>
<a name="l491"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_ERR_UNC_DLP        0x00000010        </span><span class=cB2>/* Data Link Protocol */</span><span class=cB0>
<a name="l492"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_ERR_UNC_POISON_TLP        0x00001000        </span><span class=cB2>/* Poisoned TLP */</span><span class=cB0>
<a name="l493"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_ERR_UNC_FCP        0x00002000        </span><span class=cB2>/* Flow Control Protocol */</span><span class=cB0>
<a name="l494"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_ERR_UNC_COMP_TIME        0x00004000        </span><span class=cB2>/* Completion Timeout */</span><span class=cB0>
<a name="l495"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_ERR_UNC_COMP_ABORT        0x00008000        </span><span class=cB2>/* Completer Abort */</span><span class=cB0>
<a name="l496"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_ERR_UNC_UNX_COMP        0x00010000        </span><span class=cB2>/* Unexpected Completion */</span><span class=cB0>
<a name="l497"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_ERR_UNC_RX_OVER        0x00020000        </span><span class=cB2>/* Receiver Overflow */</span><span class=cB0>
<a name="l498"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_ERR_UNC_MALF_TLP        0x00040000        </span><span class=cB2>/* Malformed TLP */</span><span class=cB0>
<a name="l499"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_ERR_UNC_ECRC        0x00080000        </span><span class=cB2>/* ECRC Error Status */</span><span class=cB0>
<a name="l500"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_ERR_UNC_UNSUP        0x00100000        </span><span class=cB2>/* Unsupported Request */</span><span class=cB0>
<a name="l501"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_ERR_UNCOR_MASK        8        </span><span class=cB2>/* Uncorrectable Error Mask */</span><span class=cB0>
<a name="l502"></a></span><span class=cB2>/* Same bits as above */</span><span class=cB0>
<a name="l503"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_ERR_UNCOR_SEVER        12        </span><span class=cB2>/* Uncorrectable Error Severity */</span><span class=cB0>
<a name="l504"></a></span><span class=cB2>/* Same bits as above */</span><span class=cB0>
<a name="l505"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_ERR_COR_STATUS        16        </span><span class=cB2>/* Correctable Error Status */</span><span class=cB0>
<a name="l506"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_ERR_COR_RCVR        0x00000001        </span><span class=cB2>/* Receiver Error Status */</span><span class=cB0>
<a name="l507"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_ERR_COR_BAD_TLP        0x00000040        </span><span class=cB2>/* Bad TLP Status */</span><span class=cB0>
<a name="l508"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_ERR_COR_BAD_DLLP        0x00000080        </span><span class=cB2>/* Bad DLLP Status */</span><span class=cB0>
<a name="l509"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_ERR_COR_REP_ROLL        0x00000100        </span><span class=cB2>/* REPLAY_NUM Rollover */</span><span class=cB0>
<a name="l510"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_ERR_COR_REP_TIMER        0x00001000        </span><span class=cB2>/* Replay Timer Timeout */</span><span class=cB0>
<a name="l511"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_ERR_COR_MASK        20        </span><span class=cB2>/* Correctable Error Mask */</span><span class=cB0>
<a name="l512"></a></span><span class=cB2>/* Same bits as above */</span><span class=cB0>
<a name="l513"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_ERR_CAP                24        </span><span class=cB2>/* Advanced Error Capabilities */</span><span class=cB0>
<a name="l514"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_ERR_CAP_FEP(x)        (</span><span class=cB7>(</span><span class=cB0>x</span><span class=cB7>)</span><span class=cB0> &amp; 31)        </span><span class=cB2>/* First Error Pointer */</span><span class=cB0>
<a name="l515"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_ERR_CAP_ECRC_GENC        0x00000020        </span><span class=cB2>/* ECRC Generation Capable */</span><span class=cB0>
<a name="l516"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_ERR_CAP_ECRC_GENE        0x00000040        </span><span class=cB2>/* ECRC Generation Enable */</span><span class=cB0>
<a name="l517"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_ERR_CAP_ECRC_CHKC        0x00000080        </span><span class=cB2>/* ECRC Check Capable */</span><span class=cB0>
<a name="l518"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_ERR_CAP_ECRC_CHKE        0x00000100        </span><span class=cB2>/* ECRC Check Enable */</span><span class=cB0>
<a name="l519"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_ERR_HEADER_LOG        28        </span><span class=cB2>/* Header Log Register (16 bytes) */</span><span class=cB0>
<a name="l520"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_ERR_ROOT_COMMAND        44        </span><span class=cB2>/* Root Error Command */</span><span class=cB0>
<a name="l521"></a></span><span class=cB2>/* Correctable Err Reporting Enable */</span><span class=cB0>
<a name="l522"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_ERR_ROOT_CMD_COR_EN                0x00000001
<a name="l523"></a></span><span class=cB2>/* Non-fatal Err Reporting Enable */</span><span class=cB0>
<a name="l524"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_ERR_ROOT_CMD_NONFATAL_EN        0x00000002
<a name="l525"></a></span><span class=cB2>/* Fatal Err Reporting Enable */</span><span class=cB0>
<a name="l526"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_ERR_ROOT_CMD_FATAL_EN        0x00000004
<a name="l527"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_ERR_ROOT_STATUS        48
<a name="l528"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_ERR_ROOT_COR_RCV                0x00000001        </span><span class=cB2>/* ERR_COR Received */</span><span class=cB0>
<a name="l529"></a></span><span class=cB2>/* Multi ERR_COR Received */</span><span class=cB0>
<a name="l530"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_ERR_ROOT_MULTI_COR_RCV        0x00000002
<a name="l531"></a></span><span class=cB2>/* ERR_FATAL/NONFATAL Recevied */</span><span class=cB0>
<a name="l532"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_ERR_ROOT_UNCOR_RCV                0x00000004
<a name="l533"></a></span><span class=cB2>/* Multi ERR_FATAL/NONFATAL Recevied */</span><span class=cB0>
<a name="l534"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_ERR_ROOT_MULTI_UNCOR_RCV        0x00000008
<a name="l535"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_ERR_ROOT_FIRST_FATAL        0x00000010        </span><span class=cB2>/* First Fatal */</span><span class=cB0>
<a name="l536"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_ERR_ROOT_NONFATAL_RCV        0x00000020        </span><span class=cB2>/* Non-Fatal Received */</span><span class=cB0>
<a name="l537"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_ERR_ROOT_FATAL_RCV                0x00000040        </span><span class=cB2>/* Fatal Received */</span><span class=cB0>
<a name="l538"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_ERR_ROOT_COR_SRC        52
<a name="l539"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_ERR_ROOT_SRC        54
<a name="l540"></a>
<a name="l541"></a></span><span class=cB2>/* Virtual Channel */</span><span class=cB0>
<a name="l542"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_VC_PORT_REG1        4
<a name="l543"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_VC_PORT_REG2        8
<a name="l544"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_VC_PORT_CTRL        12
<a name="l545"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_VC_PORT_STATUS        14
<a name="l546"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_VC_RES_CAP                16
<a name="l547"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_VC_RES_CTRL                20
<a name="l548"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_VC_RES_STATUS        26
<a name="l549"></a>
<a name="l550"></a></span><span class=cB2>/* Power Budgeting */</span><span class=cB0>
<a name="l551"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_PWR_DSR                4        </span><span class=cB2>/* Data Select Register */</span><span class=cB0>
<a name="l552"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_PWR_DATA                8        </span><span class=cB2>/* Data Register */</span><span class=cB0>
<a name="l553"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_PWR_DATA_BASE(x)        (</span><span class=cB7>(</span><span class=cB0>x</span><span class=cB7>)</span><span class=cB0> &amp; 0xff)            </span><span class=cB2>/* Base Power */</span><span class=cB0>
<a name="l554"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_PWR_DATA_SCALE(x)        (</span><span class=cB7>(</span><span class=cB0>(x) &gt;&gt; 8</span><span class=cB7>)</span><span class=cB0> &amp; 3)    </span><span class=cB2>/* Data Scale */</span><span class=cB0>
<a name="l555"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_PWR_DATA_PM_SUB(x)        (</span><span class=cB7>(</span><span class=cB0>(x) &gt;&gt; 10</span><span class=cB7>)</span><span class=cB0> &amp; 7)   </span><span class=cB2>/* PM Sub State */</span><span class=cB0>
<a name="l556"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_PWR_DATA_PM_STATE(x) (</span><span class=cB7>(</span><span class=cB0>(x) &gt;&gt; 13</span><span class=cB7>)</span><span class=cB0> &amp; 3) </span><span class=cB2>/* PM State */</span><span class=cB0>
<a name="l557"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_PWR_DATA_TYPE(x)        (</span><span class=cB7>(</span><span class=cB0>(x) &gt;&gt; 15</span><span class=cB7>)</span><span class=cB0> &amp; 7)   </span><span class=cB2>/* Type */</span><span class=cB0>
<a name="l558"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_PWR_DATA_RAIL(x)        (</span><span class=cB7>(</span><span class=cB0>(x) &gt;&gt; 18</span><span class=cB7>)</span><span class=cB0> &amp; 7)   </span><span class=cB2>/* Power Rail */</span><span class=cB0>
<a name="l559"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_PWR_CAP                12        </span><span class=cB2>/* Capability */</span><span class=cB0>
<a name="l560"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_PWR_CAP_BUDGET(x)        (</span><span class=cB7>(</span><span class=cB0>x</span><span class=cB7>)</span><span class=cB0> &amp; 1)        </span><span class=cB2>/* Included in system budget */</span><span class=cB0>
<a name="l561"></a>
<a name="l562"></a></span><span class=cB2>/*</span><span class=cB0>
<a name="l563"></a></span><span class=cB2> * Hypertransport sub capability types</span><span class=cB0>
<a name="l564"></a></span><span class=cB2> *</span><span class=cB0>
<a name="l565"></a></span><span class=cB2> * Unfortunately there are both 3 bit and 5 bit capability types defined</span><span class=cB0>
<a name="l566"></a></span><span class=cB2> * in the HT spec, catering for that is a little messy. You probably don't</span><span class=cB0>
<a name="l567"></a></span><span class=cB2> * want to use these directly, just use pci_find_ht_capability() and it</span><span class=cB0>
<a name="l568"></a></span><span class=cB2> * will do the right thing for you.</span><span class=cB0>
<a name="l569"></a></span><span class=cB2> */</span><span class=cB0>
<a name="l570"></a>#</span><span class=cB1>define</span><span class=cB0> HT_3BIT_CAP_MASK        0xE0
<a name="l571"></a>#</span><span class=cB1>define</span><span class=cB0> HT_CAPTYPE_SLAVE        0x00        </span><span class=cB2>/* Slave/Primary link configuration */</span><span class=cB0>
<a name="l572"></a>#</span><span class=cB1>define</span><span class=cB0> HT_CAPTYPE_HOST                0x20        </span><span class=cB2>/* Host/Secondary link configuration */</span><span class=cB0>
<a name="l573"></a>
<a name="l574"></a>#</span><span class=cB1>define</span><span class=cB0> HT_5BIT_CAP_MASK        0xF8
<a name="l575"></a>#</span><span class=cB1>define</span><span class=cB0> HT_CAPTYPE_IRQ                0x80        </span><span class=cB2>/* IRQ Configuration */</span><span class=cB0>
<a name="l576"></a>#</span><span class=cB1>define</span><span class=cB0> HT_CAPTYPE_REMAPPING_40        0xA0        </span><span class=cB2>/* 40 bit address remapping */</span><span class=cB0>
<a name="l577"></a>#</span><span class=cB1>define</span><span class=cB0> HT_CAPTYPE_REMAPPING_64 0xA2        </span><span class=cB2>/* 64 bit address remapping */</span><span class=cB0>
<a name="l578"></a>#</span><span class=cB1>define</span><span class=cB0> HT_CAPTYPE_UNITID_CLUMP        0x90        </span><span class=cB2>/* Unit ID clumping */</span><span class=cB0>
<a name="l579"></a>#</span><span class=cB1>define</span><span class=cB0> HT_CAPTYPE_EXTCONF        0x98        </span><span class=cB2>/* Extended Configuration Space Access */</span><span class=cB0>
<a name="l580"></a>#</span><span class=cB1>define</span><span class=cB0> HT_CAPTYPE_MSI_MAPPING        0xA8        </span><span class=cB2>/* MSI Mapping Capability */</span><span class=cB0>
<a name="l581"></a>#</span><span class=cB1>define</span><span class=cB0>  HT_MSI_FLAGS                0x02                </span><span class=cB2>/* Offset to flags */</span><span class=cB0>
<a name="l582"></a>#</span><span class=cB1>define</span><span class=cB0>  HT_MSI_FLAGS_ENABLE        0x1                </span><span class=cB2>/* Mapping enable */</span><span class=cB0>
<a name="l583"></a>#</span><span class=cB1>define</span><span class=cB0>  HT_MSI_FLAGS_FIXED        0x2                </span><span class=cB2>/* Fixed mapping only */</span><span class=cB0>
<a name="l584"></a>#</span><span class=cB1>define</span><span class=cB0>  HT_MSI_FIXED_ADDR        0x00000000FEE00000ULL        </span><span class=cB2>/* Fixed addr */</span><span class=cB0>
<a name="l585"></a>#</span><span class=cB1>define</span><span class=cB0>  HT_MSI_ADDR_LO                0x04                </span><span class=cB2>/* Offset to low addr bits */</span><span class=cB0>
<a name="l586"></a>#</span><span class=cB1>define</span><span class=cB0>  HT_MSI_ADDR_LO_MASK        0xFFF00000        </span><span class=cB2>/* Low address bit mask */</span><span class=cB0>
<a name="l587"></a>#</span><span class=cB1>define</span><span class=cB0>  HT_MSI_ADDR_HI                0x08                </span><span class=cB2>/* Offset to high addr bits */</span><span class=cB0>
<a name="l588"></a>#</span><span class=cB1>define</span><span class=cB0> HT_CAPTYPE_DIRECT_ROUTE        0xB0        </span><span class=cB2>/* Direct routing configuration */</span><span class=cB0>
<a name="l589"></a>#</span><span class=cB1>define</span><span class=cB0> HT_CAPTYPE_VCSET        0xB8        </span><span class=cB2>/* Virtual Channel configuration */</span><span class=cB0>
<a name="l590"></a>#</span><span class=cB1>define</span><span class=cB0> HT_CAPTYPE_ERROR_RETRY        0xC0        </span><span class=cB2>/* Retry on error configuration */</span><span class=cB0>
<a name="l591"></a>#</span><span class=cB1>define</span><span class=cB0> HT_CAPTYPE_GEN3                0xD0        </span><span class=cB2>/* Generation 3 hypertransport configuration */</span><span class=cB0>
<a name="l592"></a>#</span><span class=cB1>define</span><span class=cB0> HT_CAPTYPE_PM                0xE0        </span><span class=cB2>/* Hypertransport powermanagement configuration */</span><span class=cB0>
<a name="l593"></a>
<a name="l594"></a></span><span class=cB2>/* Alternative Routing-ID Interpretation */</span><span class=cB0>
<a name="l595"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_ARI_CAP                0x04        </span><span class=cB2>/* ARI Capability Register */</span><span class=cB0>
<a name="l596"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_ARI_CAP_MFVC        0x0001        </span><span class=cB2>/* MFVC Function Groups Capability */</span><span class=cB0>
<a name="l597"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_ARI_CAP_ACS        0x0002        </span><span class=cB2>/* ACS Function Groups Capability */</span><span class=cB0>
<a name="l598"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_ARI_CAP_NFN(x)        (</span><span class=cB7>(</span><span class=cB0>(x) &gt;&gt; 8</span><span class=cB7>)</span><span class=cB0> &amp; 0xff) </span><span class=cB2>/* Next Function Number */</span><span class=cB0>
<a name="l599"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_ARI_CTRL                0x06        </span><span class=cB2>/* ARI Control Register */</span><span class=cB0>
<a name="l600"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_ARI_CTRL_MFVC        0x0001        </span><span class=cB2>/* MFVC Function Groups Enable */</span><span class=cB0>
<a name="l601"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_ARI_CTRL_ACS        0x0002        </span><span class=cB2>/* ACS Function Groups Enable */</span><span class=cB0>
<a name="l602"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_ARI_CTRL_FG(x)        (</span><span class=cB7>(</span><span class=cB0>(x) &gt;&gt; 4</span><span class=cB7>)</span><span class=cB0> &amp; 7) </span><span class=cB2>/* Function Group */</span><span class=cB0>
<a name="l603"></a>
<a name="l604"></a></span><span class=cB2>/* Address Translation Service */</span><span class=cB0>
<a name="l605"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_ATS_CAP                0x04        </span><span class=cB2>/* ATS Capability Register */</span><span class=cB0>
<a name="l606"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_ATS_CAP_QDEP(x)        (</span><span class=cB7>(</span><span class=cB0>x</span><span class=cB7>)</span><span class=cB0> &amp; 0x1f)        </span><span class=cB2>/* Invalidate Queue Depth */</span><span class=cB0>
<a name="l607"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_ATS_MAX_QDEP        32        </span><span class=cB2>/* Max Invalidate Queue Depth */</span><span class=cB0>
<a name="l608"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_ATS_CTRL                0x06        </span><span class=cB2>/* ATS Control Register */</span><span class=cB0>
<a name="l609"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_ATS_CTRL_ENABLE        0x8000        </span><span class=cB2>/* ATS Enable */</span><span class=cB0>
<a name="l610"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_ATS_CTRL_STU(x)        (</span><span class=cB7>(</span><span class=cB0>x</span><span class=cB7>)</span><span class=cB0> &amp; 0x1f)        </span><span class=cB2>/* Smallest Translation Unit */</span><span class=cB0>
<a name="l611"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_ATS_MIN_STU        12        </span><span class=cB2>/* shift of minimum STU block */</span><span class=cB0>
<a name="l612"></a>
<a name="l613"></a></span><span class=cB2>/* Single Root I/O Virtualization */</span><span class=cB0>
<a name="l614"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_SRIOV_CAP                0x04        </span><span class=cB2>/* SR-IOV Capabilities */</span><span class=cB0>
<a name="l615"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_SRIOV_CAP_VFM        0x01        </span><span class=cB2>/* VF Migration Capable */</span><span class=cB0>
<a name="l616"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_SRIOV_CAP_INTR(x)        (</span><span class=cB7>(</span><span class=cB0>x</span><span class=cB7>)</span><span class=cB0> &gt;&gt; 21) </span><span class=cB2>/* Interrupt Message Number */</span><span class=cB0>
<a name="l617"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_SRIOV_CTRL                0x08        </span><span class=cB2>/* SR-IOV Control */</span><span class=cB0>
<a name="l618"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_SRIOV_CTRL_VFE        0x01        </span><span class=cB2>/* VF Enable */</span><span class=cB0>
<a name="l619"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_SRIOV_CTRL_VFM        0x02        </span><span class=cB2>/* VF Migration Enable */</span><span class=cB0>
<a name="l620"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_SRIOV_CTRL_INTR        0x04        </span><span class=cB2>/* VF Migration Interrupt Enable */</span><span class=cB0>
<a name="l621"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_SRIOV_CTRL_MSE        0x08        </span><span class=cB2>/* VF Memory Space Enable */</span><span class=cB0>
<a name="l622"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_SRIOV_CTRL_ARI        0x10        </span><span class=cB2>/* ARI Capable Hierarchy */</span><span class=cB0>
<a name="l623"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_SRIOV_STATUS        0x0a        </span><span class=cB2>/* SR-IOV Status */</span><span class=cB0>
<a name="l624"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_SRIOV_STATUS_VFM        0x01        </span><span class=cB2>/* VF Migration Status */</span><span class=cB0>
<a name="l625"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_SRIOV_INITIAL_VF        0x0c        </span><span class=cB2>/* Initial VFs */</span><span class=cB0>
<a name="l626"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_SRIOV_TOTAL_VF        0x0e        </span><span class=cB2>/* Total VFs */</span><span class=cB0>
<a name="l627"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_SRIOV_NUM_VF        0x10        </span><span class=cB2>/* Number of VFs */</span><span class=cB0>
<a name="l628"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_SRIOV_FUNC_LINK        0x12        </span><span class=cB2>/* Function Dependency Link */</span><span class=cB0>
<a name="l629"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_SRIOV_VF_OFFSET        0x14        </span><span class=cB2>/* First VF Offset */</span><span class=cB0>
<a name="l630"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_SRIOV_VF_STRIDE        0x16        </span><span class=cB2>/* Following VF Stride */</span><span class=cB0>
<a name="l631"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_SRIOV_VF_DID        0x1a        </span><span class=cB2>/* VF Device ID */</span><span class=cB0>
<a name="l632"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_SRIOV_SUP_PGSIZE        0x1c        </span><span class=cB2>/* Supported Page Sizes */</span><span class=cB0>
<a name="l633"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_SRIOV_SYS_PGSIZE        0x20        </span><span class=cB2>/* System Page Size */</span><span class=cB0>
<a name="l634"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_SRIOV_BAR                0x24        </span><span class=cB2>/* VF BAR0 */</span><span class=cB0>
<a name="l635"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_SRIOV_NUM_BARS        6        </span><span class=cB2>/* Number of VF BARs */</span><span class=cB0>
<a name="l636"></a>#</span><span class=cB1>define</span><span class=cB0> PCI_SRIOV_VFM                0x3c        </span><span class=cB2>/* VF Migration State Array Offset*/</span><span class=cB0>
<a name="l637"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_SRIOV_VFM_BIR(x)        (</span><span class=cB7>(</span><span class=cB0>x</span><span class=cB7>)</span><span class=cB0> &amp; 7)        </span><span class=cB2>/* State BIR */</span><span class=cB0>
<a name="l638"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_SRIOV_VFM_OFFSET(x) (</span><span class=cB7>(</span><span class=cB0>x</span><span class=cB7>)</span><span class=cB0> &amp; ~7)        </span><span class=cB2>/* State Offset */</span><span class=cB0>
<a name="l639"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_SRIOV_VFM_UA        0x0        </span><span class=cB2>/* Inactive.Unavailable */</span><span class=cB0>
<a name="l640"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_SRIOV_VFM_MI        0x1        </span><span class=cB2>/* Dormant.MigrateIn */</span><span class=cB0>
<a name="l641"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_SRIOV_VFM_MO        0x2        </span><span class=cB2>/* Active.MigrateOut */</span><span class=cB0>
<a name="l642"></a>#</span><span class=cB1>define</span><span class=cB0>  PCI_SRIOV_VFM_AV        0x3        </span><span class=cB2>/* Active.Available */</span><span class=cB0>
<a name="l643"></a>
<a name="l644"></a>
<a name="l645"></a></span><span class=cB1>class</span><span class=cB0> acpi_table_header
<a name="l646"></a>{
<a name="l647"></a>  </span><span class=cB1>I8</span><span class=cB0> signature[4];      </span><span class=cB2>/* ASCII table signature */</span><span class=cB0>
<a name="l648"></a>  </span><span class=cB9>U32</span><span class=cB0> length;           </span><span class=cB2>/* Length of table in bytes, including this header */</span><span class=cB0>
<a name="l649"></a>  </span><span class=cB1>U8</span><span class=cB0> revision;          </span><span class=cB2>/* ACPI Specification minor version number */</span><span class=cB0>
<a name="l650"></a>  </span><span class=cB1>U8</span><span class=cB0> checksum;          </span><span class=cB2>/* To make sum of entire table == 0 */</span><span class=cB0>
<a name="l651"></a>  </span><span class=cB1>I8</span><span class=cB0> oem_id[6]; </span><span class=cB2>/* ASCII OEM identification */</span><span class=cB0>
<a name="l652"></a>  </span><span class=cB1>I8</span><span class=cB0> oem_table_id[8];   </span><span class=cB2>/* ASCII OEM table identification */</span><span class=cB0>
<a name="l653"></a>  </span><span class=cB9>U32</span><span class=cB0> oem_revision;     </span><span class=cB2>/* OEM revision number */</span><span class=cB0>
<a name="l654"></a>  </span><span class=cB9>U32</span><span class=cB0> asl_compiler_id;  </span><span class=cB2>/* ASCII ASL compiler vendor ID */</span><span class=cB0>
<a name="l655"></a>  </span><span class=cB9>U32</span><span class=cB0> asl_compiler_revision;    </span><span class=cB2>/* ASL compiler version */</span><span class=cB0>
<a name="l656"></a>};
<a name="l657"></a>
<a name="l658"></a></span><span class=cB1>class</span><span class=cB0> acpi_table_mcfg
<a name="l659"></a>{
<a name="l660"></a>  acpi_table_header header;     </span><span class=cB2>/* Common ACPI table header */</span><span class=cB0>
<a name="l661"></a>  </span><span class=cB1>U8</span><span class=cB0> pad[8];
<a name="l662"></a>};
<a name="l663"></a>
<a name="l664"></a></span><span class=cB2>/* Subtable */</span><span class=cB0>
<a name="l665"></a>
<a name="l666"></a></span><span class=cB1>class</span><span class=cB0> acpi_mcfg_allocation
<a name="l667"></a>{
<a name="l668"></a>  </span><span class=cB9>U64</span><span class=cB0> address;          </span><span class=cB2>/* Base address, processor-relative */</span><span class=cB0>
<a name="l669"></a>  </span><span class=cB9>U16</span><span class=cB0> pci_segment;      </span><span class=cB2>/* PCI segment group number */</span><span class=cB0>
<a name="l670"></a>  </span><span class=cB1>U8</span><span class=cB0> start_bus_number;  </span><span class=cB2>/* Starting PCI Bus number */</span><span class=cB0>
<a name="l671"></a>  </span><span class=cB1>U8</span><span class=cB0> end_bus_number;    </span><span class=cB2>/* Final PCI Bus number */</span><span class=cB0>
<a name="l672"></a>  </span><span class=cB9>U32</span><span class=cB0> reserved;
<a name="l673"></a>};
<a name="l674"></a>
<a name="l675"></a></span><span class=cB1>class</span><span class=cB0> mcfg_entry
<a name="l676"></a>{
<a name="l677"></a>  </span><span class=cB9>U64</span><span class=cB0>         addr;
<a name="l678"></a>  </span><span class=cB9>U16</span><span class=cB0>         segment;
<a name="l679"></a>  </span><span class=cB1>U8</span><span class=cB0>          bus_start;
<a name="l680"></a>  </span><span class=cB1>U8</span><span class=cB0>          bus_end;
<a name="l681"></a>};
<a name="l682"></a>
<a name="l683"></a>
<a name="l684"></a></span><span class=cB1>Bool</span><span class=cB0> <a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l684"></span><span class=cBD>AcpiTableChecksum</a></span><span class=cB0>(acpi_table_header *header)
<a name="l685"></a>{
<a name="l686"></a>  </span><span class=cB9>I64</span><span class=cB0> i, sum = 0;
<a name="l687"></a>  </span><span class=cB1>I8</span><span class=cB0> *header_bytes = header;
<a name="l688"></a>  </span><span class=cB1>for</span><span class=cB0> (i = 0; i &lt; header-&gt;length; i++)
<a name="l689"></a>  </span><span class=cB7>{</span><span class=cB0>
<a name="l690"></a>    sum += header_bytes[i];
<a name="l691"></a>  </span><span class=cB7>}</span><span class=cB0>
<a name="l692"></a>  sum = sum &amp; 0xff;
<a name="l693"></a>  </span><span class=cB1>return</span><span class=cB0> sum == 0;
<a name="l694"></a>}
<a name="l695"></a>
<a name="l696"></a>mcfg_entry *<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l696"></span><span class=cBD>mcfg_entries</a></span><span class=cB0>;
<a name="l697"></a></span><span class=cB9>I64</span><span class=cB0> <a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l697"></span><span class=cBD>n_mcfg_entries</a></span><span class=cB0>;
<a name="l698"></a>
<a name="l699"></a></span><span class=cB1>Bool</span><span class=cB0> <a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l699"></span><span class=cBD>PcieCfgParse</a></span><span class=cB0>(acpi_table_header *header, mcfg_entry **<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l696"></span><span class=cBD>mcfg_entries</a></span><span class=cB0>, </span><span class=cB9>I64</span><span class=cB0> *<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l697"></span><span class=cBD>n_mcfg_entries</a></span><span class=cB0>)
<a name="l700"></a>{
<a name="l701"></a>  acpi_table_mcfg *mcfg;
<a name="l702"></a>  acpi_mcfg_allocation *mptr;
<a name="l703"></a>  mcfg_entry *e, *arr;
<a name="l704"></a>  </span><span class=cB9>I64</span><span class=cB0> i, n;
<a name="l705"></a>  </span><span class=cB1>if</span><span class=cB0> (<a href="http://tinkeros.github.io/WbGit/Kernel/KernelB.html#l170"></span><span class=cB5>MemCmp</a></span><span class=cB7>(</span><span class=cB0>header-&gt;signature, </span><span class=cB6>&quot;MCFG&quot;</span><span class=cB0>, 4</span><span class=cB7>)</span><span class=cB0>)
<a name="l706"></a>    </span><span class=cB1>return</span><span class=cB0> 0;
<a name="l707"></a>  </span><span class=cB6>&quot;MCFG signature ok\n&quot;</span><span class=cB0>;
<a name="l708"></a>  </span><span class=cB1>if</span><span class=cB0> (header-&gt;length &lt; </span><span class=cB1>sizeof</span><span class=cB7>(</span><span class=cB0>acpi_table_mcfg</span><span class=cB7>)</span><span class=cB0>)
<a name="l709"></a>    </span><span class=cB1>return</span><span class=cB0> 0;
<a name="l710"></a>  </span><span class=cB6>&quot;MCFG length ok\n&quot;</span><span class=cB0>;
<a name="l711"></a>  </span><span class=cB1>if</span><span class=cB0> (!<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l684"></span><span class=cBD>AcpiTableChecksum</a></span><span class=cB7>(</span><span class=cB0>header</span><span class=cB7>)</span><span class=cB0>)
<a name="l712"></a>    </span><span class=cB1>return</span><span class=cB0> 0;
<a name="l713"></a>  </span><span class=cB6>&quot;MCFG checksum ok\n&quot;</span><span class=cB0>;
<a name="l714"></a>  n = (header-&gt;length - </span><span class=cB1>sizeof</span><span class=cB7>(</span><span class=cB0>acpi_table_mcfg</span><span class=cB7>)</span><span class=cB0>) / </span><span class=cB1>sizeof</span><span class=cB0>(acpi_mcfg_allocation);
<a name="l715"></a>  mcfg = header;
<a name="l716"></a>  mptr = &amp;mcfg[1];
<a name="l717"></a>  arr = <a href="http://tinkeros.github.io/WbGit/Kernel/Mem/MAllocFree.html#l427"></span><span class=cB5>CAlloc</a></span><span class=cB0>(n * </span><span class=cB1>sizeof</span><span class=cB7>(</span><span class=cB0>mcfg_entry</span><span class=cB7>)</span><span class=cB0>);
<a name="l718"></a>  </span><span class=cB1>if</span><span class=cB0> (!arr)
<a name="l719"></a>    </span><span class=cB1>return</span><span class=cB0> 0;
<a name="l720"></a>  </span><span class=cB1>for</span><span class=cB0> (i = 0, e = arr; i &lt; n; i++, mptr++, e++)
<a name="l721"></a>  </span><span class=cB7>{</span><span class=cB0>
<a name="l722"></a>    e-&gt;segment = mptr-&gt;pci_segment;
<a name="l723"></a>    e-&gt;addr =  mptr-&gt;address;
<a name="l724"></a>    e-&gt;bus_start = mptr-&gt;start_bus_number;
<a name="l725"></a>    e-&gt;bus_end = mptr-&gt;end_bus_number;
<a name="l726"></a>  </span><span class=cB7>}</span><span class=cB0>
<a name="l727"></a>  </span><span class=cB6>&quot;MCFG table detected, %d entries\n&quot;</span><span class=cB0>, n;
<a name="l728"></a>  *<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l696"></span><span class=cBD>mcfg_entries</a></span><span class=cB0> = arr;
<a name="l729"></a>  *<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l697"></span><span class=cBD>n_mcfg_entries</a></span><span class=cB0> =n;
<a name="l730"></a>}
<a name="l731"></a>
<a name="l732"></a></span><span class=cB9>I64</span><span class=cB0> <a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l732"></span><span class=cB5>PcieCfgRead</a></span><span class=cB0>(</span><span class=cB1>U8</span><span class=cB0> *base, </span><span class=cB9>I64</span><span class=cB0> reg_offset, </span><span class=cB9>I64</span><span class=cB0> len)
<a name="l733"></a>{
<a name="l734"></a>  </span><span class=cB1>I8</span><span class=cB0>  *base1 = &amp;base[reg_offset];
<a name="l735"></a>  </span><span class=cB9>I16</span><span class=cB0> *base2 = &amp;base[reg_offset];
<a name="l736"></a>  </span><span class=cB9>I32</span><span class=cB0> *base4 = &amp;base[reg_offset];
<a name="l737"></a>  </span><span class=cB9>I64</span><span class=cB0> value=0, *base8 = &amp;base[reg_offset];
<a name="l738"></a>  </span><span class=cB1>switch</span><span class=cB0> (len)
<a name="l739"></a>  </span><span class=cB7>{</span><span class=cB0>
<a name="l740"></a>  </span><span class=cB1>case</span><span class=cB0> 1:
<a name="l741"></a>    value = *base1 &amp; 0xff;
<a name="l742"></a>    </span><span class=cB1>break</span><span class=cB0>;
<a name="l743"></a>  </span><span class=cB1>case</span><span class=cB0> 2:
<a name="l744"></a>    value = *base2 &amp; 0xffff;
<a name="l745"></a>    </span><span class=cB1>break</span><span class=cB0>;
<a name="l746"></a>  </span><span class=cB1>case</span><span class=cB0> 4:
<a name="l747"></a>    value = *base4 &amp; 0xffffffff;
<a name="l748"></a>    </span><span class=cB1>break</span><span class=cB0>;
<a name="l749"></a>  </span><span class=cB1>case</span><span class=cB0> 8:
<a name="l750"></a>    value = *base8 &amp; 0xffffffff;
<a name="l751"></a>    </span><span class=cB1>break</span><span class=cB0>;
<a name="l752"></a>    </span><span class=cB6>&quot;Invalid length %d\n&quot;</span><span class=cB0>
<a name="l753"></a>    ,len;
<a name="l754"></a>  </span><span class=cB7>}</span><span class=cB0>
<a name="l755"></a>  </span><span class=cB1>return</span><span class=cB0> value;
<a name="l756"></a>}
<a name="l757"></a>
<a name="l758"></a></span><span class=cB1>U0</span><span class=cB0> <a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l758"></span><span class=cB5>PcieCfgWrite</a></span><span class=cB0>(</span><span class=cB1>U8</span><span class=cB0> *base, </span><span class=cB9>I64</span><span class=cB0> reg_offset, </span><span class=cB9>I64</span><span class=cB0> len, </span><span class=cB9>I64</span><span class=cB0> value)
<a name="l759"></a>{
<a name="l760"></a>  </span><span class=cB1>I8</span><span class=cB0>  *base1 = &amp;base[reg_offset];
<a name="l761"></a>  </span><span class=cB9>I16</span><span class=cB0> *base2 = &amp;base[reg_offset];
<a name="l762"></a>  </span><span class=cB9>I32</span><span class=cB0> *base4 = &amp;base[reg_offset];
<a name="l763"></a>  </span><span class=cB9>I64</span><span class=cB0> *base8 = &amp;base[reg_offset];
<a name="l764"></a>  </span><span class=cB1>switch</span><span class=cB0> (len)
<a name="l765"></a>  </span><span class=cB7>{</span><span class=cB0>
<a name="l766"></a>  </span><span class=cB1>case</span><span class=cB0> 1:
<a name="l767"></a>    *base1 = value &amp; 0xff;
<a name="l768"></a>    </span><span class=cB1>break</span><span class=cB0>;
<a name="l769"></a>  </span><span class=cB1>case</span><span class=cB0> 2:
<a name="l770"></a>    *base2 = value &amp; 0xffff;
<a name="l771"></a>    </span><span class=cB1>break</span><span class=cB0>;
<a name="l772"></a>  </span><span class=cB1>case</span><span class=cB0> 4:
<a name="l773"></a>    *base4 = value &amp; 0xffffffff;
<a name="l774"></a>    </span><span class=cB1>break</span><span class=cB0>;
<a name="l775"></a>  </span><span class=cB1>case</span><span class=cB0> 8:
<a name="l776"></a>    *base8 = value &amp; 0xffffffff;
<a name="l777"></a>    </span><span class=cB1>break</span><span class=cB0>;
<a name="l778"></a>    </span><span class=cB6>&quot;Invalid length %d\n&quot;</span><span class=cB0>
<a name="l779"></a>    ,len;
<a name="l780"></a>  </span><span class=cB7>}</span><span class=cB0>
<a name="l781"></a>}
<a name="l782"></a>
<a name="l783"></a></span><span class=cB1>U8</span><span class=cB0> *<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l783"></span><span class=cBD>FindMCFG2</a></span><span class=cB0>()
<a name="l784"></a>{
<a name="l785"></a>  </span><span class=cB1>U8</span><span class=cB0> *ptr = 0x88B00000, *stop = 0x88F00000; </span><span class=cB2>//TODO need to make this always work!</span><span class=cB0>
<a name="l786"></a>  </span><span class=cB1>while</span><span class=cB0> (ptr &lt; stop)
<a name="l787"></a>  </span><span class=cB7>{</span><span class=cB0>
<a name="l788"></a>    </span><span class=cB1>if</span><span class=cB0> (!<a href="http://tinkeros.github.io/WbGit/Kernel/KernelB.html#l170"></span><span class=cB5>MemCmp</a></span><span class=cB7>(</span><span class=cB0>ptr,</span><span class=cB6>&quot;MCFG&quot;</span><span class=cB0>,4</span><span class=cB7>)</span><span class=cB0>)
<a name="l789"></a>    {
<a name="l790"></a>      </span><span class=cB1>if</span><span class=cB0> (<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l684"></span><span class=cBD>AcpiTableChecksum</a></span><span class=cB7>(</span><span class=cB0>ptr</span><span class=cB7>)</span><span class=cB0>)
<a name="l791"></a>        </span><span class=cB1>return</span><span class=cB0> ptr;
<a name="l792"></a>    }
<a name="l793"></a>    ptr += 8;
<a name="l794"></a>  </span><span class=cB7>}</span><span class=cB0>
<a name="l795"></a>  </span><span class=cB1>return</span><span class=cB0> 0;
<a name="l796"></a>}
<a name="l797"></a>
<a name="l798"></a></span><span class=cB1>U8</span><span class=cB0> *<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l798"></span><span class=cBD>FindMCFG</a></span><span class=cB0>()
<a name="l799"></a>{
<a name="l800"></a>  </span><span class=cB1>U8</span><span class=cB0> *ptr = 0xD86E0000, *stop = 0xDAFF0000; </span><span class=cB2>//TODO need to make this always work!</span><span class=cB0>
<a name="l801"></a>  </span><span class=cB1>while</span><span class=cB0> (ptr &lt; stop)
<a name="l802"></a>  </span><span class=cB7>{</span><span class=cB0>
<a name="l803"></a>    </span><span class=cB1>if</span><span class=cB0> (!<a href="http://tinkeros.github.io/WbGit/Kernel/KernelB.html#l170"></span><span class=cB5>MemCmp</a></span><span class=cB7>(</span><span class=cB0>ptr,</span><span class=cB6>&quot;MCFG&quot;</span><span class=cB0>,4</span><span class=cB7>)</span><span class=cB0>)
<a name="l804"></a>    {
<a name="l805"></a>      </span><span class=cB1>if</span><span class=cB0> (<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l684"></span><span class=cBD>AcpiTableChecksum</a></span><span class=cB7>(</span><span class=cB0>ptr</span><span class=cB7>)</span><span class=cB0>)
<a name="l806"></a>        </span><span class=cB1>return</span><span class=cB0> ptr;
<a name="l807"></a>    }
<a name="l808"></a>    ptr += 8;
<a name="l809"></a>  </span><span class=cB7>}</span><span class=cB0>
<a name="l810"></a>  </span><span class=cB2>//return 0;</span><span class=cB0>
<a name="l811"></a>  </span><span class=cB1>return</span><span class=cB0> <a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l783"></span><span class=cBD>FindMCFG2</a></span><span class=cB0>;
<a name="l812"></a>}
<a name="l813"></a>
<a name="l814"></a></span><span class=cB2>//TODO</span><span class=cB0>
<a name="l815"></a></span><span class=cB2>// add global arrays for com/parallel ports</span><span class=cB0>
<a name="l816"></a></span><span class=cB2>// populate them here</span><span class=cB0>
<a name="l817"></a></span><span class=cB2>// use them in Comm.HC</span><span class=cB0>
<a name="l818"></a></span><span class=cB2>//</span><span class=cB0>
<a name="l819"></a></span><span class=cB1>U0</span><span class=cB0> <a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l819"></span><span class=cBD>EnumPcieDeviceIds</a></span><span class=cB0>(mcfg_entry *arr, </span><span class=cB9>I64</span><span class=cB0> n)
<a name="l820"></a>{
<a name="l821"></a>  </span><span class=cB1>U8</span><span class=cB0> pci_class, pci_subclass, header_type,irq_line,irq_pin,*cfg_space;
<a name="l822"></a>  </span><span class=cB9>U16</span><span class=cB0> vendor_id, device_id;
<a name="l823"></a>  </span><span class=cB9>U32</span><span class=cB0> *bar;
<a name="l824"></a>  </span><span class=cB9>I64</span><span class=cB0> bi,i, Bus, Device, Function=0;
<a name="l825"></a>  mcfg_entry *e;
<a name="l826"></a>  </span><span class=cB1>for</span><span class=cB0> (i=0; i&lt;n; i++)
<a name="l827"></a>  </span><span class=cB7>{</span><span class=cB0>
<a name="l828"></a>    </span><span class=cB6>&quot;Enumerating devices from MCFG entry %d\n&quot;</span><span class=cB0>,i;
<a name="l829"></a>    e=&amp;arr[i];
<a name="l830"></a>    </span><span class=cB1>for</span><span class=cB0> (Bus=e-&gt;bus_start; Bus&lt;=e-&gt;bus_end; Bus++)
<a name="l831"></a>    {
<a name="l832"></a>      </span><span class=cB1>for</span><span class=cB0> (Device=0; Device&lt;32; Device++)
<a name="l833"></a>      </span><span class=cB7>{</span><span class=cB0>
<a name="l834"></a>        </span><span class=cB1>for</span><span class=cB0> (Function=0; Function&lt;8; Function++)
<a name="l835"></a>        {
<a name="l836"></a>          cfg_space = e-&gt;addr + ( </span><span class=cB7>(</span><span class=cB0>Bus - e-&gt;bus_start</span><span class=cB7>)</span><span class=cB0> &lt;&lt; 20 | Device &lt;&lt; 15 | Function &lt;&lt; 12);
<a name="l837"></a>          vendor_id = <a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l732"></span><span class=cB5>PcieCfgRead</a></span><span class=cB0>(cfg_space, PCI_VENDOR_ID, 2);
<a name="l838"></a>          device_id = <a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l732"></span><span class=cB5>PcieCfgRead</a></span><span class=cB0>(cfg_space, PCI_DEVICE_ID, 2);
<a name="l839"></a>          </span><span class=cB1>if</span><span class=cB0> (vendor_id != 0xffff &amp;&amp; device_id != 0xffff)
<a name="l840"></a>          </span><span class=cB7>{</span><span class=cB0>
<a name="l841"></a>            pci_subclass = <a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l732"></span><span class=cB5>PcieCfgRead</a></span><span class=cB0>(cfg_space, PCI_CLASS_DEVICE, 1);
<a name="l842"></a>            pci_class = <a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l732"></span><span class=cB5>PcieCfgRead</a></span><span class=cB0>(cfg_space, PCI_CLASS_DEVICE+1, 1);
<a name="l843"></a>            header_type = <a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l732"></span><span class=cB5>PcieCfgRead</a></span><span class=cB0>(cfg_space, PCI_HEADER_TYPE, 1);
<a name="l844"></a>            irq_pin=<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l732"></span><span class=cB5>PcieCfgRead</a></span><span class=cB0>(cfg_space,PCI_INTERRUPT_PIN,1);
<a name="l845"></a>            irq_line=<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l732"></span><span class=cB5>PcieCfgRead</a></span><span class=cB0>(cfg_space,PCI_INTERRUPT_LINE,1);
<a name="l846"></a>            </span><span class=cB6>&quot;Bus %d Device %d Func %d Header Type %02x Vendor ID %04x Device ID %04x\n&quot;</span><span class=cB0>
<a name="l847"></a>            ,Bus,Device,Function,header_type,vendor_id,device_id;
<a name="l848"></a>            </span><span class=cB6>&quot;Class %02x Sub-Class %02x IRQ line: %d IRQ pin %02x\n&quot;</span><span class=cB0>
<a name="l849"></a>            ,pci_class,pci_subclass,irq_line,irq_pin;
<a name="l850"></a>            </span><span class=cB1>if</span><span class=cB0> (header_type == 0)
<a name="l851"></a>            {
<a name="l852"></a>              bar = &amp;cfg_space[PCI_BASE_ADDRESS_0];
<a name="l853"></a>              </span><span class=cB1>for</span><span class=cB0> (bi=0; bi&lt;6; bi++)
<a name="l854"></a>              </span><span class=cB7>{</span><span class=cB0>
<a name="l855"></a>                </span><span class=cB1>if</span><span class=cB0> (bar[bi]&amp;0x1)
<a name="l856"></a>                {
<a name="l857"></a>                  </span><span class=cB6>&quot;Bar %d I/O port %08x\n&quot;</span><span class=cB0>, bi, bar[bi] &amp; 0xFFFFFFFC;
<a name="l858"></a>                }
<a name="l859"></a>                </span><span class=cB1>else</span><span class=cB0>
<a name="l860"></a>                {
<a name="l861"></a>                  </span><span class=cB1>if</span><span class=cB0> (bar[bi] &amp; ~0x1F&gt;0)
<a name="l862"></a>                    </span><span class=cB6>&quot;Bar %d Address: %x\n&quot;</span><span class=cB0>,bi,bar[bi] &amp; ~0x1F;
<a name="l863"></a>                }
<a name="l864"></a>              </span><span class=cB7>}</span><span class=cB0>
<a name="l865"></a>            }
<a name="l866"></a>            </span><span class=cB6>&quot;\n&quot;</span><span class=cB0>;
<a name="l867"></a>          </span><span class=cB7>}</span><span class=cB0>
<a name="l868"></a>        }
<a name="l869"></a>      </span><span class=cB7>}</span><span class=cB0>
<a name="l870"></a>    }
<a name="l871"></a>  </span><span class=cB7>}</span><span class=cB0>
<a name="l872"></a>}
<a name="l873"></a>
<a name="l874"></a></span><span class=cB9>U32</span><span class=cB0> <a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l874"></span><span class=cBD>GetPcieDevBarSearch</a></span><span class=cB0>(mcfg_entry *arr, </span><span class=cB9>I64</span><span class=cB0> n, </span><span class=cB9>I64</span><span class=cB0> find_class, </span><span class=cB9>I64</span><span class=cB0> find_subclass, </span><span class=cB9>I64</span><span class=cB0> bar_index, </span><span class=cB9>I64</span><span class=cB0> cnt=0, </span><span class=cB1>Bool</span><span class=cB0> io_only=<a href="http://tinkeros.github.io/WbGit/Kernel/KernelA.html#l23"></span><span class=cB3>FALSE</a></span><span class=cB0>)
<a name="l875"></a>{
<a name="l876"></a>  </span><span class=cB1>U8</span><span class=cB0> pci_class, pci_subclass, header_type,irq_line,irq_pin,*cfg_space;
<a name="l877"></a>  </span><span class=cB9>U16</span><span class=cB0> vendor_id, device_id;
<a name="l878"></a>  </span><span class=cB9>U32</span><span class=cB0> *bar;
<a name="l879"></a>  </span><span class=cB9>I64</span><span class=cB0> bi,i,Bus, Device, Function=0, cur=0;
<a name="l880"></a>  mcfg_entry *e;
<a name="l881"></a>  </span><span class=cB1>for</span><span class=cB0> (i=0; i&lt;n; i++)
<a name="l882"></a>  </span><span class=cB7>{</span><span class=cB0>
<a name="l883"></a>    </span><span class=cB6>&quot;Enumerating devices from MCFG entry %d\n&quot;</span><span class=cB0>,i;
<a name="l884"></a>    e=&amp;arr[i];
<a name="l885"></a>    </span><span class=cB1>for</span><span class=cB0> (Bus=e-&gt;bus_start; Bus&lt;=e-&gt;bus_end; Bus++)
<a name="l886"></a>    {
<a name="l887"></a>      </span><span class=cB1>for</span><span class=cB0> (Device=0; Device&lt;32; Device++)
<a name="l888"></a>      </span><span class=cB7>{</span><span class=cB0>
<a name="l889"></a>        </span><span class=cB1>for</span><span class=cB0> (Function=0; Function&lt;8; Function++)
<a name="l890"></a>        {
<a name="l891"></a>          cfg_space = e-&gt;addr + ( </span><span class=cB7>(</span><span class=cB0>Bus - e-&gt;bus_start</span><span class=cB7>)</span><span class=cB0> &lt;&lt; 20 | Device &lt;&lt; 15 | Function &lt;&lt; 12);
<a name="l892"></a>          vendor_id = <a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l732"></span><span class=cB5>PcieCfgRead</a></span><span class=cB0>(cfg_space, PCI_VENDOR_ID, 2);
<a name="l893"></a>          device_id = <a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l732"></span><span class=cB5>PcieCfgRead</a></span><span class=cB0>(cfg_space, PCI_DEVICE_ID, 2);
<a name="l894"></a>          </span><span class=cB1>if</span><span class=cB0> (vendor_id != 0xffff &amp;&amp; device_id != 0xffff)
<a name="l895"></a>          </span><span class=cB7>{</span><span class=cB0>
<a name="l896"></a>            pci_subclass = <a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l732"></span><span class=cB5>PcieCfgRead</a></span><span class=cB0>(cfg_space, PCI_CLASS_DEVICE, 1);
<a name="l897"></a>            pci_class = <a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l732"></span><span class=cB5>PcieCfgRead</a></span><span class=cB0>(cfg_space, PCI_CLASS_DEVICE+1, 1);
<a name="l898"></a>            header_type = <a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l732"></span><span class=cB5>PcieCfgRead</a></span><span class=cB0>(cfg_space, PCI_HEADER_TYPE, 1);
<a name="l899"></a>            irq_pin=<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l732"></span><span class=cB5>PcieCfgRead</a></span><span class=cB0>(cfg_space,PCI_INTERRUPT_PIN,1);
<a name="l900"></a>            irq_line=<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l732"></span><span class=cB5>PcieCfgRead</a></span><span class=cB0>(cfg_space,PCI_INTERRUPT_LINE,1);
<a name="l901"></a>            </span><span class=cB1>if</span><span class=cB0> (header_type == 0)
<a name="l902"></a>            {
<a name="l903"></a>              bar = &amp;cfg_space[PCI_BASE_ADDRESS_0];
<a name="l904"></a>              </span><span class=cB1>for</span><span class=cB0> (bi=0; bi&lt;6; bi++)
<a name="l905"></a>              </span><span class=cB7>{</span><span class=cB0>
<a name="l906"></a>                </span><span class=cB1>if</span><span class=cB0> (bar_index == bi &amp;&amp; pci_class == find_class &amp;&amp; pci_subclass == find_subclass)
<a name="l907"></a>                {
<a name="l908"></a>                  </span><span class=cB1>if</span><span class=cB0> (bar[bi]&amp;0x1 &amp; !io_only)
<a name="l909"></a>                  </span><span class=cB7>{</span><span class=cB0>
<a name="l910"></a>                    </span><span class=cB1>if</span><span class=cB0> (cur == cnt)
<a name="l911"></a>                    {
<a name="l912"></a>                      </span><span class=cB1>return</span><span class=cB0> bar[bi] &amp; 0xFFFFFFFC;
<a name="l913"></a>                    }
<a name="l914"></a>                    </span><span class=cB1>else</span><span class=cB0>
<a name="l915"></a>                    {
<a name="l916"></a>                      cur++;
<a name="l917"></a>                    }
<a name="l918"></a>                  </span><span class=cB7>}</span><span class=cB0>
<a name="l919"></a>                  </span><span class=cB1>else</span><span class=cB0>
<a name="l920"></a>                  </span><span class=cB7>{</span><span class=cB0>
<a name="l921"></a>                    </span><span class=cB1>if</span><span class=cB0> (bar[bi] &amp; ~0x1F&gt;0)
<a name="l922"></a>                    {
<a name="l923"></a>                      </span><span class=cB1>if</span><span class=cB0> (cur == cnt)
<a name="l924"></a>                      </span><span class=cB7>{</span><span class=cB0>
<a name="l925"></a>                        </span><span class=cB1>return</span><span class=cB0> bar[bi] &amp; ~0x1F;
<a name="l926"></a>                      </span><span class=cB7>}</span><span class=cB0>
<a name="l927"></a>                      </span><span class=cB1>else</span><span class=cB0>
<a name="l928"></a>                      </span><span class=cB7>{</span><span class=cB0>
<a name="l929"></a>                        cur++;
<a name="l930"></a>                      </span><span class=cB7>}</span><span class=cB0>
<a name="l931"></a>                    }
<a name="l932"></a>                  </span><span class=cB7>}</span><span class=cB0>
<a name="l933"></a>                }
<a name="l934"></a>              </span><span class=cB7>}</span><span class=cB0>
<a name="l935"></a>            }
<a name="l936"></a>          </span><span class=cB7>}</span><span class=cB0>
<a name="l937"></a>        }
<a name="l938"></a>      </span><span class=cB7>}</span><span class=cB0>
<a name="l939"></a>    }
<a name="l940"></a>  </span><span class=cB7>}</span><span class=cB0>
<a name="l941"></a>  </span><span class=cB1>return</span><span class=cB0> 0;
<a name="l942"></a>}
<a name="l943"></a>
<a name="l944"></a></span><span class=cB1>U8</span><span class=cB0> *<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l944"></span><span class=cBD>GetPcieDevSearch</a></span><span class=cB0>(mcfg_entry *arr, </span><span class=cB9>I64</span><span class=cB0> n, </span><span class=cB9>I64</span><span class=cB0> find_vendor_id, </span><span class=cB9>I64</span><span class=cB0> find_device_id)
<a name="l945"></a>{
<a name="l946"></a>  </span><span class=cB1>U8</span><span class=cB0> header_type,*cfg_space;
<a name="l947"></a>  </span><span class=cB9>U16</span><span class=cB0> vendor_id, device_id;
<a name="l948"></a>  </span><span class=cB9>I64</span><span class=cB0> i, Bus, Device, Function=0;
<a name="l949"></a>  mcfg_entry *e;
<a name="l950"></a>  </span><span class=cB1>for</span><span class=cB0> (i=0; i&lt;n; i++)
<a name="l951"></a>  </span><span class=cB7>{</span><span class=cB0>
<a name="l952"></a>    </span><span class=cB6>&quot;Enumerating devices from MCFG entry %d\n&quot;</span><span class=cB0>,i;
<a name="l953"></a>    e=&amp;arr[i];
<a name="l954"></a>    </span><span class=cB1>for</span><span class=cB0> (Bus=e-&gt;bus_start; Bus&lt;=e-&gt;bus_end; Bus++)
<a name="l955"></a>    {
<a name="l956"></a>      </span><span class=cB1>for</span><span class=cB0> (Device=0; Device&lt;32; Device++)
<a name="l957"></a>      </span><span class=cB7>{</span><span class=cB0>
<a name="l958"></a>        </span><span class=cB1>for</span><span class=cB0> (Function=0; Function&lt;8; Function++)
<a name="l959"></a>        {
<a name="l960"></a>          cfg_space = e-&gt;addr + ( </span><span class=cB7>(</span><span class=cB0>Bus - e-&gt;bus_start</span><span class=cB7>)</span><span class=cB0> &lt;&lt; 20 | Device &lt;&lt; 15 | Function &lt;&lt; 12);
<a name="l961"></a>          vendor_id = <a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l732"></span><span class=cB5>PcieCfgRead</a></span><span class=cB0>(cfg_space, PCI_VENDOR_ID, 2);
<a name="l962"></a>          device_id = <a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l732"></span><span class=cB5>PcieCfgRead</a></span><span class=cB0>(cfg_space, PCI_DEVICE_ID, 2);
<a name="l963"></a>          </span><span class=cB1>if</span><span class=cB0> (vendor_id != 0xffff &amp;&amp; device_id != 0xffff)
<a name="l964"></a>          </span><span class=cB7>{</span><span class=cB0>
<a name="l965"></a>            header_type = <a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l732"></span><span class=cB5>PcieCfgRead</a></span><span class=cB0>(cfg_space, PCI_HEADER_TYPE, 1);
<a name="l966"></a>            </span><span class=cB1>if</span><span class=cB0> (header_type == 0)
<a name="l967"></a>            {
<a name="l968"></a>              </span><span class=cB1>if</span><span class=cB0> (vendor_id == find_vendor_id &amp;&amp; device_id == find_device_id)
<a name="l969"></a>              </span><span class=cB7>{</span><span class=cB0>
<a name="l970"></a>                </span><span class=cB1>return</span><span class=cB0> cfg_space;
<a name="l971"></a>              </span><span class=cB7>}</span><span class=cB0>
<a name="l972"></a>            }
<a name="l973"></a>          </span><span class=cB7>}</span><span class=cB0>
<a name="l974"></a>        }
<a name="l975"></a>      </span><span class=cB7>}</span><span class=cB0>
<a name="l976"></a>    }
<a name="l977"></a>  </span><span class=cB7>}</span><span class=cB0>
<a name="l978"></a>  </span><span class=cB1>return</span><span class=cB0> 0;
<a name="l979"></a>}
<a name="l980"></a>
<a name="l981"></a></span><span class=cB1>public</span><span class=cB0> </span><span class=cB1>U0</span><span class=cB0> <a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l981"></span><span class=cB5>EnumPcie</a></span><span class=cB0>()
<a name="l982"></a>{
<a name="l983"></a>  mcfg_entry *<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l696"></span><span class=cBD>mcfg_entries</a></span><span class=cB0>;
<a name="l984"></a>  </span><span class=cB9>I64</span><span class=cB0> <a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l697"></span><span class=cBD>n_mcfg_entries</a></span><span class=cB0>;
<a name="l985"></a>  </span><span class=cB1>if</span><span class=cB0> (!<a href="http://tinkeros.github.io/WbGit/Kernel/KGlbls.html#l56"></span><span class=cBD>MCFGTableAddr</a></span><span class=cB0>)
<a name="l986"></a>    <a href="http://tinkeros.github.io/WbGit/Kernel/KGlbls.html#l56"></span><span class=cBD>MCFGTableAddr</a></span><span class=cB0>=<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l798"></span><span class=cBD>FindMCFG</a></span><span class=cB0>();
<a name="l987"></a>  </span><span class=cB1>if</span><span class=cB0> (<a href="http://tinkeros.github.io/WbGit/Kernel/KGlbls.html#l56"></span><span class=cBD>MCFGTableAddr</a></span><span class=cB0>)
<a name="l988"></a>  </span><span class=cB7>{</span><span class=cB0>
<a name="l989"></a>    <a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l699"></span><span class=cBD>PcieCfgParse</a></span><span class=cB0>(<a href="http://tinkeros.github.io/WbGit/Kernel/KGlbls.html#l56"></span><span class=cBD>MCFGTableAddr</a></span><span class=cB0>, &amp;<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l696"></span><span class=cBD>mcfg_entries</a></span><span class=cB0>, &amp;<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l697"></span><span class=cBD>n_mcfg_entries</a></span><span class=cB0>);
<a name="l990"></a>    <a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l819"></span><span class=cBD>EnumPcieDeviceIds</a></span><span class=cB0>(<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l696"></span><span class=cBD>mcfg_entries</a></span><span class=cB0>, <a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l697"></span><span class=cBD>n_mcfg_entries</a></span><span class=cB0>);
<a name="l991"></a>    <a href="http://tinkeros.github.io/WbGit/Kernel/Mem/MAllocFree.html#l415"></span><span class=cB5>Free</a></span><span class=cB0>(<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l696"></span><span class=cBD>mcfg_entries</a></span><span class=cB0>);
<a name="l992"></a>  </span><span class=cB7>}</span><span class=cB0>
<a name="l993"></a>  </span><span class=cB1>else</span><span class=cB0>
<a name="l994"></a>  </span><span class=cB7>{</span><span class=cB0>
<a name="l995"></a>    </span><span class=cB6>&quot;Could not find MCFG table!\n&quot;</span><span class=cB0>;
<a name="l996"></a>  </span><span class=cB7>}</span><span class=cB0>
<a name="l997"></a>}
<a name="l998"></a>
<a name="l999"></a></span><span class=cB1>public</span><span class=cB0> </span><span class=cB9>I64</span><span class=cB0> <a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l999"></span><span class=cB5>GetPcieDevBarIO</a></span><span class=cB0>(</span><span class=cB9>I64</span><span class=cB0> find_class, </span><span class=cB9>I64</span><span class=cB0> find_subclass, </span><span class=cB9>I64</span><span class=cB0> bar_index, </span><span class=cB9>I64</span><span class=cB0> n=0)
<a name="l1000"></a>{
<a name="l1001"></a>  mcfg_entry *<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l696"></span><span class=cBD>mcfg_entries</a></span><span class=cB0>;
<a name="l1002"></a>  </span><span class=cB9>I64</span><span class=cB0> <a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l697"></span><span class=cBD>n_mcfg_entries</a></span><span class=cB0>,res=-1;
<a name="l1003"></a>  </span><span class=cB1>if</span><span class=cB0> (!<a href="http://tinkeros.github.io/WbGit/Kernel/KGlbls.html#l56"></span><span class=cBD>MCFGTableAddr</a></span><span class=cB0>)
<a name="l1004"></a>    <a href="http://tinkeros.github.io/WbGit/Kernel/KGlbls.html#l56"></span><span class=cBD>MCFGTableAddr</a></span><span class=cB0>=<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l798"></span><span class=cBD>FindMCFG</a></span><span class=cB0>();
<a name="l1005"></a>  </span><span class=cB1>if</span><span class=cB0> (<a href="http://tinkeros.github.io/WbGit/Kernel/KGlbls.html#l56"></span><span class=cBD>MCFGTableAddr</a></span><span class=cB0>)
<a name="l1006"></a>  </span><span class=cB7>{</span><span class=cB0>
<a name="l1007"></a>    <a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l699"></span><span class=cBD>PcieCfgParse</a></span><span class=cB0>(<a href="http://tinkeros.github.io/WbGit/Kernel/KGlbls.html#l56"></span><span class=cBD>MCFGTableAddr</a></span><span class=cB0>, &amp;<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l696"></span><span class=cBD>mcfg_entries</a></span><span class=cB0>, &amp;<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l697"></span><span class=cBD>n_mcfg_entries</a></span><span class=cB0>);
<a name="l1008"></a>    res=<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l874"></span><span class=cBD>GetPcieDevBarSearch</a></span><span class=cB0>(<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l696"></span><span class=cBD>mcfg_entries</a></span><span class=cB0>, <a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l697"></span><span class=cBD>n_mcfg_entries</a></span><span class=cB0>, find_class, find_subclass, bar_index, n, <a href="http://tinkeros.github.io/WbGit/Kernel/KernelA.html#l22"></span><span class=cB3>TRUE</a></span><span class=cB0>);
<a name="l1009"></a>    <a href="http://tinkeros.github.io/WbGit/Kernel/Mem/MAllocFree.html#l415"></span><span class=cB5>Free</a></span><span class=cB0>(<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l696"></span><span class=cBD>mcfg_entries</a></span><span class=cB0>);
<a name="l1010"></a>  </span><span class=cB7>}</span><span class=cB0>
<a name="l1011"></a>  </span><span class=cB1>else</span><span class=cB0>
<a name="l1012"></a>  </span><span class=cB7>{</span><span class=cB0>
<a name="l1013"></a>    </span><span class=cB6>&quot;Could not find MCFG table!\n&quot;</span><span class=cB0>;
<a name="l1014"></a>    </span><span class=cB1>return</span><span class=cB0> -1;
<a name="l1015"></a>  </span><span class=cB7>}</span><span class=cB0>
<a name="l1016"></a>  </span><span class=cB1>if</span><span class=cB0> (res == 0)
<a name="l1017"></a>    res=-1;
<a name="l1018"></a>  </span><span class=cB1>return</span><span class=cB0> res;
<a name="l1019"></a>}
<a name="l1020"></a>
<a name="l1021"></a></span><span class=cB1>public</span><span class=cB0> </span><span class=cB9>I64</span><span class=cB0> <a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l1021"></span><span class=cB5>GetPcieDevBar</a></span><span class=cB0>(</span><span class=cB9>I64</span><span class=cB0> find_class, </span><span class=cB9>I64</span><span class=cB0> find_subclass, </span><span class=cB9>I64</span><span class=cB0> bar_index, </span><span class=cB9>I64</span><span class=cB0> n=0)
<a name="l1022"></a>{
<a name="l1023"></a>  mcfg_entry *<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l696"></span><span class=cBD>mcfg_entries</a></span><span class=cB0>;
<a name="l1024"></a>  </span><span class=cB9>I64</span><span class=cB0> <a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l697"></span><span class=cBD>n_mcfg_entries</a></span><span class=cB0>,res=-1;
<a name="l1025"></a>  </span><span class=cB1>if</span><span class=cB0> (!<a href="http://tinkeros.github.io/WbGit/Kernel/KGlbls.html#l56"></span><span class=cBD>MCFGTableAddr</a></span><span class=cB0>)
<a name="l1026"></a>    <a href="http://tinkeros.github.io/WbGit/Kernel/KGlbls.html#l56"></span><span class=cBD>MCFGTableAddr</a></span><span class=cB0>=<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l798"></span><span class=cBD>FindMCFG</a></span><span class=cB0>();
<a name="l1027"></a>  </span><span class=cB1>if</span><span class=cB0> (<a href="http://tinkeros.github.io/WbGit/Kernel/KGlbls.html#l56"></span><span class=cBD>MCFGTableAddr</a></span><span class=cB0>)
<a name="l1028"></a>  </span><span class=cB7>{</span><span class=cB0>
<a name="l1029"></a>    <a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l699"></span><span class=cBD>PcieCfgParse</a></span><span class=cB0>(<a href="http://tinkeros.github.io/WbGit/Kernel/KGlbls.html#l56"></span><span class=cBD>MCFGTableAddr</a></span><span class=cB0>, &amp;<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l696"></span><span class=cBD>mcfg_entries</a></span><span class=cB0>, &amp;<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l697"></span><span class=cBD>n_mcfg_entries</a></span><span class=cB0>);
<a name="l1030"></a>    res=<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l874"></span><span class=cBD>GetPcieDevBarSearch</a></span><span class=cB0>(<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l696"></span><span class=cBD>mcfg_entries</a></span><span class=cB0>, <a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l697"></span><span class=cBD>n_mcfg_entries</a></span><span class=cB0>, find_class, find_subclass, bar_index, n);
<a name="l1031"></a>    <a href="http://tinkeros.github.io/WbGit/Kernel/Mem/MAllocFree.html#l415"></span><span class=cB5>Free</a></span><span class=cB0>(<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l696"></span><span class=cBD>mcfg_entries</a></span><span class=cB0>);
<a name="l1032"></a>  </span><span class=cB7>}</span><span class=cB0>
<a name="l1033"></a>  </span><span class=cB1>else</span><span class=cB0>
<a name="l1034"></a>  </span><span class=cB7>{</span><span class=cB0>
<a name="l1035"></a>    </span><span class=cB6>&quot;Could not find MCFG table!\n&quot;</span><span class=cB0>;
<a name="l1036"></a>    </span><span class=cB1>return</span><span class=cB0> -1;
<a name="l1037"></a>  </span><span class=cB7>}</span><span class=cB0>
<a name="l1038"></a>  </span><span class=cB1>if</span><span class=cB0> (res == 0)
<a name="l1039"></a>    res=-1;
<a name="l1040"></a>  </span><span class=cB1>return</span><span class=cB0> res;
<a name="l1041"></a>}
<a name="l1042"></a>
<a name="l1043"></a></span><span class=cB1>U8</span><span class=cB0> *<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l1043"></span><span class=cB5>PcieFindDev</a></span><span class=cB0>(</span><span class=cB9>I64</span><span class=cB0> vendor_id, </span><span class=cB9>I64</span><span class=cB0> device_id)
<a name="l1044"></a>{
<a name="l1045"></a>  mcfg_entry *<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l696"></span><span class=cBD>mcfg_entries</a></span><span class=cB0>;
<a name="l1046"></a>  </span><span class=cB9>I64</span><span class=cB0> <a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l697"></span><span class=cBD>n_mcfg_entries</a></span><span class=cB0>,res=-1;
<a name="l1047"></a>  </span><span class=cB1>if</span><span class=cB0> (!<a href="http://tinkeros.github.io/WbGit/Kernel/KGlbls.html#l56"></span><span class=cBD>MCFGTableAddr</a></span><span class=cB0>)
<a name="l1048"></a>    <a href="http://tinkeros.github.io/WbGit/Kernel/KGlbls.html#l56"></span><span class=cBD>MCFGTableAddr</a></span><span class=cB0>=<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l798"></span><span class=cBD>FindMCFG</a></span><span class=cB0>();
<a name="l1049"></a>  </span><span class=cB1>if</span><span class=cB0> (<a href="http://tinkeros.github.io/WbGit/Kernel/KGlbls.html#l56"></span><span class=cBD>MCFGTableAddr</a></span><span class=cB0>)
<a name="l1050"></a>  </span><span class=cB7>{</span><span class=cB0>
<a name="l1051"></a>    <a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l699"></span><span class=cBD>PcieCfgParse</a></span><span class=cB0>(<a href="http://tinkeros.github.io/WbGit/Kernel/KGlbls.html#l56"></span><span class=cBD>MCFGTableAddr</a></span><span class=cB0>, &amp;<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l696"></span><span class=cBD>mcfg_entries</a></span><span class=cB0>, &amp;<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l697"></span><span class=cBD>n_mcfg_entries</a></span><span class=cB0>);
<a name="l1052"></a>    res=<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l944"></span><span class=cBD>GetPcieDevSearch</a></span><span class=cB0>(<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l696"></span><span class=cBD>mcfg_entries</a></span><span class=cB0>, <a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l697"></span><span class=cBD>n_mcfg_entries</a></span><span class=cB0>, vendor_id, device_id);
<a name="l1053"></a>    <a href="http://tinkeros.github.io/WbGit/Kernel/Mem/MAllocFree.html#l415"></span><span class=cB5>Free</a></span><span class=cB0>(<a href="http://tinkeros.github.io/WbGit/Kernel/PCIEACPI.html#l696"></span><span class=cBD>mcfg_entries</a></span><span class=cB0>);
<a name="l1054"></a>  </span><span class=cB7>}</span><span class=cB0>
<a name="l1055"></a>  </span><span class=cB1>else</span><span class=cB0>
<a name="l1056"></a>  </span><span class=cB7>{</span><span class=cB0>
<a name="l1057"></a>    </span><span class=cB6>&quot;Could not find MCFG table!\n&quot;</span><span class=cB0>;
<a name="l1058"></a>    </span><span class=cB1>return</span><span class=cB0> -1;
<a name="l1059"></a>  </span><span class=cB7>}</span><span class=cB0>
<a name="l1060"></a>  </span><span class=cB1>if</span><span class=cB0> (res == 0)
<a name="l1061"></a>    res=-1;
<a name="l1062"></a>  </span><span class=cB1>return</span><span class=cB0> res;
<a name="l1063"></a>}
</span></div></pre></body>
</html>
